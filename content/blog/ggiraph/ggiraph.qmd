---
title: Convierte gr치ficos {ggplot2} en visualizaciones interactivas con {ggiraph}
author: Basti치n Olea Herrera
date: '2025-11-07'
draft: false
freeze: true
slug: []
categories:
  - Tutoriales
tags:
  - visualizaci칩n de datos
  - ggplot2
format:
  hugo-md:
    output-file: index
    output-ext: md
links: 
  - icon: registered
    icon_pack: fas
    name: ggiraph
    url: https://davidgohel.github.io/ggiraph/
  - icon: github
    icon_pack: fab
    name: c칩digo
    url: https://gist.github.com/bastianolea/f51c59c3937544ae5fb235d6eb522fd1
excerpt: "`{ggiraph}` es un paquete de R que permite agregar interactividad a gr치ficos `{ggplot2}`. Esto significa que tus gr치ficos podr치n mostrar informaci칩n extra al pasar el cursor encima (_tooltips_), hacer que se destaquen u oculten elementos al pasar el cursor, hacer clic en elementos del gr치fico para generar cambios en aplicaciones, y m치s. Tambi칠n es posible combinar la interactividad de dos o m치s gr치ficos, lo que permite crear visualizaciones m치s complejas y reveladoras."
---

{{< imagen "featured.png" >}}

`{ggiraph}` es un paquete de R que permite agregar **interactividad** a gr치ficos `{ggplot2}`. Esto significa que tus gr치ficos podr치n mostrar informaci칩n extra al pasar el cursor encima (_tooltips_), hacer que se destaquen u oculten elementos al pasar el cursor, hacer clic en elementos del gr치fico para generar cambios en aplicaciones, y m치s.

Un beneficio de `{ggiraph}` es que, a diferencia de alternativas como `{plotly}` o `{highcharter}`, **no necesitas aprender a usar un paquete de visualizaci칩n nuevo**, porque `{ggiraph}` usa los gr치ficos generados por `{ggplot2}` y **mantiene al 100% su apariencia**. Esto significa que tu gr치fico interactivo se ver치 id칠ntico a tu gr치fico de `{ggplot2}` (a diferencia de con `ggplotly()` 游). Esto es gracias a que `{ggiraph}` toma el gr치fico que hiciste y lo convierte a `SVG`, un formato de imagen vectorial que es compatible con HTML y CSS, lo que permite la interactividad.

## Introducci칩n

Lo primero es instalar el paquete:

```{r}
#| eval: false
install.packages("ggiraph")
```

En t칠rminos generales, el procedimiento para crear gr치ficos interactivos con `{ggiraph}` es:

1. Hacer un gr치fico con `{ggplot2}`
2. Cambiar las funciones `geom_x()` por `geom_x_interactive()`
3. Usar la funci칩n `girafe()` en vez de `plot()` para generar el gr치fico interactivo.

Ve치moslo con un ejemplo:

## Adaptar gr치ficos

Para entender el proceso, crearemos un gr치fico b치sico y luego lo adaptaremos para incluir interactividad.

Vamos a crear un [gr치fico de dispersi칩n con `{ggplot2}`](/blog/r_introduccion/tutorial_visualizacion_ggplot/#dispersi칩n), agreg치ndole un [tema de colores personalizado con `{thematic}`](/blog/ggplot_temas/).


```{r}
library(ggplot2)
library(thematic)

thematic_on(bg = "#EAD1FA",
            fg = "#6E3998",
            accent = "#9069C0")

iris |> 
  ggplot(aes(Sepal.Length, Sepal.Width, color = Species)) +
  geom_point(size = 2) +
  scale_color_brewer(palette = "Dark2")
```
Ahora convertimos el gr치fico en interactivo usando `{ggiraph}`. Para ello, identificaremos las [funciones de geometr칤as](/blog/r_introduccion/tutorial_visualizacion_ggplot/#introducci칩n) del gr치fico (en este caso `geom_point()` y la cambiaremos a `geom_point_interactive()`. Esta capa del gr치fico seguir치 funcionando igual que antes, pero ahora podremos agregarle nuevos argumentos:

- En el argumento `data_id`, dentro de `aes()` indicaremos una variable que identifique los elementos del gr치fico. Esto puede ser un **identificador 칰nico** si queremos que la interactividad se aplique a cada elemento de manera independiente, o una variable que **agrupe las observaciones** para aplicar interactividad que opere a varios elementos a la vez.
- El argumento `tooltip` dentro de `aes()` ser치 donde definamos el **texto que aparecer치 al pasar el cursor** sobre un elemento del gr치fico. En este texto podemos usar `paste()` o `glue()` para agregar informaci칩n de otras variables que correspondan al elemento destacado, y tambi칠n podemos usar HTML para dar estilo al texto.


```{r}
#| message: false
library(ggiraph)
library(dplyr)
library(glue)

grafico <- iris |> 
  mutate(id = row_number()) |> # identificador de observaciones
  ggplot(aes(Sepal.Length, Sepal.Width, color = Species)) +
  # geom point(size = 3) +
  geom_point_interactive(
    size = 3,
    aes(data_id = id,
        tooltip = glue("<b>Largo:</b> {Sepal.Length}
                        <b>Ancho:</b> {Sepal.Width}
                        <b>Especie:</b> {Species}"))
  ) +
  scale_color_brewer(palette = "Dark2")
```

Una vez hechas las modificaciones, en vez de usar `plot(grafico)`, usaremos la funci칩n `girafe()` para generar el gr치fico interactivo:

```{r}
girafe(ggobj = grafico)
```

Pasa el cursor sobre el gr치fico para ver la interactividad!

## Tooltips

Una de las funcionalidades principales en la interactividad de gr치ficos es el _tooltip_, que es el cuadro de texto que aparece al pasar el cursor sobre un elemento del gr치fico. Sirven para poder mostrar **datos extra sobre los elementos del gr치fico** sin saturar la visualizaci칩n, tales como cifras exactas, textos que describen la observaci칩n, etc.

Para modificar el estilo del _tooltip_, usamos la funci칩n `opts_tooltip()` dentro del argumento `options` de `girafe()`. Ah칤 podemos escribir c칩digo CSS para configurar el estilo, como color de fondo y texto, tipograf칤a, tama침os y espaciados, y m치s.

```{r}

estilo_tooltip <- "background-color: #EAD1FA;
                  color: black;
                  font-family: sans-serif;
                  font-size: 9pt;
                  padding: 6px; padding-left: 8px; padding-right: 8px;
                  border-radius: 4px;"

girafe(ggobj = grafico,
       options = list(
         # estilo de tooltip
         opts_tooltip(css = estilo_tooltip),
         # ocultar botones
         opts_toolbar(saveaspng = FALSE))
)
```

Dentro de `opts_tooltip()`, el argumento `use_fill` hace que el color del _tooltip_ coincida con el color del elemento del gr치fico, definido por la paleta de colores y la variable asignada al color.

```{r}
girafe(ggobj = grafico,
       options = list(
         opts_toolbar(saveaspng = FALSE),
         # estilo de tooltip
         opts_tooltip(use_fill = TRUE,
                      css = estilo_tooltip))
)
```


## Hover

El _hover_ es el efecto visual que ocurre cuando pasamos el cursor sobre un elemento del gr치fico. Podemos usarlo para destacar un punto, agrandarlo, cambiar su color, o hacer que el resto de los puntos pasen a segundo plano.

Con `opts_hover()` definimos el estilo CSS para los puntos en estado de _hover_, mientras que con `opts_hover_inv()` definimos el estilo CSS para los puntos que no est치n en estado de _hover_; es decir, el resto de los puntos.

Podemos cambiar el color del punto bajo el cursor:

```{r}
girafe(ggobj = grafico,
       options = list(
         opts_toolbar(saveaspng = FALSE),
         opts_tooltip(use_fill = TRUE, css = estilo_tooltip),
         # opciones de hover
         opts_hover(css = "stroke: #6E3998; fill: #6E3998;")
       ))
```

Agrandar el punto y hacer que el resto de los puntos se transparenten:

```{r}
girafe(ggobj = grafico,
       options = list(
         # estilo de tooltip
         opts_tooltip(use_fill = TRUE, css = estilo_tooltip),
         # ocultar botones
         opts_toolbar(saveaspng = FALSE),
         # opciones de hover
         opts_hover(css = "stroke-width: 4px;"),
         opts_hover_inv(css = "opacity: 0.3;")
       ))
```

Hacer que el resto de los elementos cambien de color al posar el cursor sobre un punto:

```{r}
girafe(ggobj = grafico,
       options = list(
         # estilo de tooltip
         opts_tooltip(use_fill = TRUE, css = estilo_tooltip),
         # ocultar botones
         opts_toolbar(saveaspng = FALSE),
         # opciones de hover
         opts_hover(css = "stroke: none;"),
         opts_hover_inv(css = "stroke: grey; fill: grey; opacity: 0.3;")
       ))
```



## Combinar gr치ficos interactivos

Otra funcionalidad clave de la interactividad es la posibilidad de que **las interacciones en un gr치fico afecten a otros gr치ficos**. Por ejemplo, posar el cursor sobre un elemento del gr치fico revela informaci칩n extra sobre el mismo elemento en un segundo gr치fico, o posar el cursor sobre una observaci칩n indica su ubicaci칩n en una segunda visualizaci칩n.

[Para **combinar gr치ficos** usaremos `{patchwork}`](/blog/patchwork/), paquete que nos permite unir dos o m치s gr치ficos en R. Si necesitas una gu칤a m치s completa sobre combinaci칩n de gr치ficos, [revisa este tutorial.]((/blog/patchwork/))

En el siguiente ejemplo, crearemos un gr치fico de dispersi칩n como el que hemos visto, pero con un `data_id` que agrupe los puntos por una variable categ칩rica, y un segundo gr치fico de barras donde dicha variable categ칩rica se use para calcular promedios de los elementos del primer gr치fico. Entonces, al pasar el cursor sobre puntos de un valor de la variable categ칩rica, se destacar치 su valor promedio en el gr치fico de barras, y viceversa.

```{r}
library(patchwork)

# gr치fico de dispersi칩n
puntos <- iris |> 
  ggplot() +
  aes(Sepal.Length, Sepal.Width, color = Species) +
  geom_point_interactive(
    size = 3,
    aes(data_id = Species,
        tooltip = glue("<b>Largo:</b> {Sepal.Length}
                        <b>Ancho:</b> {Sepal.Width}
                        <b>Especie:</b> {Species}"))) +
  scale_color_brewer(palette = "Dark2") +
  guides(color = guide_legend(position = "top"))

# gr치fico de barras
barras <- iris |> 
  group_by(Species) |> 
  summarize(Sepal.Length = mean(Sepal.Length)) |> 
  ggplot() +
  aes(Species, Sepal.Length, fill = Species) +
  geom_col_interactive(
    width = 0.4,
    aes(data_id = Species,
        tooltip = glue("<b>Largo:</b> {Sepal.Length}
                        <b>Especie:</b> {Species}"))) +
  scale_fill_brewer(palette = "Dark2") +
  guides(fill = "none")

# combinar ambos gr치ficos
combinado <- barras + puntos +
  plot_layout(widths = c(1, 3))

# interactividad
girafe(ggobj = combinado,
       options = list(
         opts_tooltip(use_fill = TRUE, css = estilo_tooltip),
         opts_toolbar(saveaspng = FALSE),
         opts_hover(css = "stroke: none;"),
         opts_hover_inv(css = "opacity: 0.3;")
       ))
```

Listo! Con pocas l칤neas de c칩digo convertimos un par de visualizaciones sencillas en algo bastante m치s interesante e informativo.

Para conocer ejemplos m치s interesantes sobre las posibilidades de `{ggplot2}` con `{ggiraph}`, recomiendo [revisar este conjunto de diapositivas](https://z3tt.github.io/ggiraph-user-2025/slides.html#/title-slide) presentadas por Tanya Shapiro y C칠dric Scherer en la [conferencia UseR 2025](https://user2025.r-project.org).

## Recursos

- [Libro de `{ggiraph}`](http://ardata.fr/ggiraph-book/), por David Gohel
- Diapositivas: [Plot Twist. Adding Interactivity to the Elegance of {ggplot2} with {ggiraph}](https://z3tt.github.io/ggiraph-user-2025/slides.html#/title-slide), por Tanya Shapiro y C칠dric Scherer

----

{{< cafecito >}}

{{< cursos >}}
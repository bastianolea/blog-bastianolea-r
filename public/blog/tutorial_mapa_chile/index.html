<!DOCTYPE html>
<html lang="es-ES" dir="ltr"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.136.5">
<title>Crea un mapa de Chile y visualiza datos comunales y regionales con mapas en R | Blog</title>


<meta property="twitter:site" content="@bastimapache">
<meta property="twitter:creator" content="@bastimapache">







  
    
  
<meta name="description" content="Visualizar datos geográficamente es una herramienta de comunicación y análisis de datos muy potente. En este tutorial te explico cómo obtener mapas comunales y regionales de Chile en R, y cómo crear un gráficos que visualizan variables numéricas en las comunas y regiones del país. En pocos pasos puedes transformar tus datos territoriales en visualizaciones mucho más densas e informativas.">


<meta property="og:site_name" content="Blog">
<meta property="og:title" content="Crea un mapa de Chile y visualiza datos comunales y regionales con mapas en R | Blog">
<meta property="og:description" content="Visualizar datos geográficamente es una herramienta de comunicación y análisis de datos muy potente. En este tutorial te explico cómo obtener mapas comunales y regionales de Chile en R, y cómo crear un gráficos que visualizan variables numéricas en las comunas y regiones del país. En pocos pasos puedes transformar tus datos territoriales en visualizaciones mucho más densas e informativas." />
<meta property="og:type" content="page" />
<meta property="og:url" content="http://localhost:4321/blog/tutorial_mapa_chile/" />
<meta property="og:locale" content="es-ES">




    
        <meta property="og:image" content="http://localhost:4321/blog/sidebar-listing.png" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="http://localhost:4321/blog/sidebar-listing.png" >
    
    
  
  <meta itemprop="name" content="Crea un mapa de Chile y visualiza datos comunales y regionales con mapas en R">
  <meta itemprop="description" content="Visualizar datos geográficamente es una herramienta de comunicación y análisis de datos muy potente. En este tutorial te explico cómo obtener mapas comunales y regionales de Chile en R, y cómo crear un gráficos que visualizan variables numéricas en las comunas y regiones del país. En pocos pasos puedes transformar tus datos territoriales en visualizaciones mucho más densas e informativas.
Para crear mapas sencillos, donde una variable numérica se visualice en cada unidad territorial por medio de una escala de colores, solamente se necesitan dos cosas: la información geográfica que te permite visualizar el mapa en sí mismo, y los datos que podamos corresponder con las unidades territoriales del mapa.">
  <meta itemprop="datePublished" content="2024-11-25T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-11-25T00:00:00+00:00">
  <meta itemprop="wordCount" content="3301">
  <meta itemprop="keywords" content="Mapas,Ggplot2,Gráficos,Ciencias sociales,Visualización de datos">
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="false" type="image/x-icon">
  <link rel="icon" href="false" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.c4fbf76e54adf7e7a1073b995dfaf4f393e11c67c30cfd5b19d29824f2cee0f0.css" integrity="sha256-xPv3blSt9&#43;ehBzuZXfr085PhHGfDDP1bGdKYJPLO4PA=" media="screen">
  
  
  <script src="/panelset.min.ed1ac24b6e16f4e2481e3d1d098ae66f5bc77438aef619e6e266d8ac5b00dc72.js" type="text/javascript"></script>
  
  
  <script src="/main.min.26a7606c1bee1310cdae7196cfade9ba0a2a95bff0c4f9cc2156609ec0d0326a.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="http://localhost:4321/" title="Home">
      <img src="/img/logo.png" class="dib db-l h2 w-auto" alt="Blog">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/blog/" title="Bastián Olea: Blog de R">Blog R</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="https://bastianolea.github.io/shiny_apps/" title="Bastián Olea: Apps">Apps</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="https://bastianolea.github.io/datos_sociales/" title="Bastián Olea: Datos">Datos</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/clases/" title="Bastián Olea: Clases">Clases</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/tags/" title="Bastián Olea: Blog">Temas</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/categories/tutoriales/" title="Bastián Olea: Tutoriales">Tutoriales</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/blog/r_introduccion/" title="Bastián Olea: Tutoriales">Intro a R</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="Bastián Olea: Sobre mi">Yo</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/contact/" title="Bastián Olea: Contacto">Contacto</a>
      
      
      
      <div class="dib v-mid", style = "padding: 4px; margin-top: 4px;">
        <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/bastianolea" title="github" target="_blank" rel="me noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://bsky.app/profile/bastianolea.rbind.io" title="bluesky" target="_blank" rel="me noopener">
      <i class="fab fa-bluesky fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://x.com/bastimapache" title="twitter" target="_blank" rel="me noopener">
      <i class="fab fa-twitter fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.linkedin.com/in/bastianolea/" title="linkedin" target="_blank" rel="me noopener">
      <i class="fab fa-linkedin fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.tiktok.com/@bastimapache" title="tiktok" target="_blank" rel="me noopener">
      <i class="fab fa-tiktok fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/raccunnie" title="instagram" target="_blank" rel="me noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.goodreads.com/user/show/53224910-basti-n-olea-herrera" title="goodreads" target="_blank" rel="me noopener">
      <i class="fab fa-goodreads fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="/contact/" title="envelope" >
      <i class="fas fa-envelope fa-lg fa-fw"></i>
    </a>
  
</div>

      </div>
      
    </div>
  </nav>
</header>

<main class="page-main pa4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 ph4-l">
      <header class="post-header">
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">Crea un mapa de Chile y visualiza datos comunales y regionales con mapas en R</h1>
        
        
        <p class="f7 db mv0 ttu">25/11/2024</p>
        
        
        
  <dl class="f6 lh-copy">
    <em><dd class="fw5 ml0">Temas:  <a href="http://localhost:4321/tags/mapas">mapas</a>  <a href="http://localhost:4321/tags/ggplot2">ggplot2</a>  <a href="http://localhost:4321/tags/gr%C3%A1ficos">gráficos</a>  <a href="http://localhost:4321/tags/ciencias-sociales">ciencias sociales</a>  <a href="http://localhost:4321/tags/visualizaci%C3%B3n-de-datos">visualización de datos</a> </dd></em>
  </dl>


        
      

      </header>
      <section class="post-body pt5 pb4">
        <p>Visualizar datos geográficamente es una herramienta de comunicación y análisis de datos muy potente. En este tutorial te explico cómo obtener mapas comunales y regionales de Chile en R, y cómo crear un gráficos que visualizan variables numéricas en las comunas y regiones del país. En pocos pasos puedes transformar tus datos territoriales en visualizaciones mucho más densas e informativas.</p>
<p>Para crear mapas sencillos, donde una variable numérica se visualice en cada unidad territorial por medio de una escala de colores, solamente se necesitan dos cosas: la información geográfica que te permite visualizar el mapa en sí mismo, y los datos que podamos corresponder con las unidades territoriales del mapa.</p>
<p>En este breve tutorial veremos cómo obtener los mapas, como unir los datos al mapa, y cómo generar visualizaciones de estos mapas en R.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">chilemapas</span><span style="color:#908caa">)</span> <span style="color:#6e6a86"># mapas de chile</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">dplyr</span><span style="color:#908caa">)</span> <span style="color:#6e6a86"># manipulación de datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">ggplot2</span><span style="color:#908caa">)</span> <span style="color:#6e6a86"># visualización de datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">scales</span><span style="color:#908caa">)</span> <span style="color:#6e6a86"># utilidad para visualización de datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">sf</span><span style="color:#908caa">)</span> <span style="color:#6e6a86"># manipulación de datos geográficos</span>
</span></span></code></pre></div>



<h2 id="mapa-de-chile-por-comunas">Mapa de Chile por comunas
  <a href="#mapa-de-chile-por-comunas"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>El paquete 
<a href="https://pacha.dev/chilemapas/" target="_blank" rel="noopener"><code>{chilemapas}</code></a>, desarrollado por 
<a href="https://pacha.dev" target="_blank" rel="noopener">Mauricio Vargas</a>, ofrece una colección de mapas terrestres de Chile con topología simplificada. Simplemente llamando el objeto <code>mapa_comunas</code> obtenemos un dataframe con la información geográfica de cada comuna del país.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_comunas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">chilemapas</span><span style="color:#908caa">::</span><span style="color:#ea9a97">mapa_comunas</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_comunas</span>
</span></span></code></pre></div><pre><code># A tibble: 345 × 4
   codigo_comuna codigo_provincia codigo_region                         geometry
   &lt;chr&gt;         &lt;chr&gt;            &lt;chr&gt;                       &lt;MULTIPOLYGON [°]&gt;
 1 01401         014              01            (((-68.86081 -21.28512, -68.921…
 2 01403         014              01            (((-68.65113 -19.77188, -68.811…
 3 01405         014              01            (((-68.65113 -19.77188, -68.635…
 4 01402         014              01            (((-69.31789 -19.13651, -69.271…
 5 01404         014              01            (((-69.39615 -19.06125, -69.400…
 6 01107         011              01            (((-70.1095 -20.35131, -70.1243…
 7 01101         011              01            (((-70.09894 -20.08504, -70.102…
 8 02104         021              02            (((-68.98863 -25.38016, -68.987…
 9 02101         021              02            (((-70.60654 -23.43054, -70.601…
10 02201         022              02            (((-67.94302 -22.38175, -67.955…
# ℹ 335 more rows
</code></pre>
<p>En este dataframe, la columna <code>geometry</code> representa los polígonos de cada comuna. Esta información ya es suficiente para visualizar el mapa con R usando <code>{ggplot2}</code> y 
<a href="https://r-spatial.github.io/sf/" target="_blank" rel="noopener"><code>{sf}</code>, un paquete para trabajar con datos espaciales</a>.</p>
<p>Para visualizar el mapa, primero usamos <code>sf::st_set_geometry()</code> para asignar la geometría al dataframe. De este modo, le indicamos a R que estos datos deben graficarse en un mapa con determinadas coordenadas e información sobre proyección.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">grafico_comunas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa_comunas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">st_set_geometry</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa_comunas</span><span style="color:#908caa">$</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># asignar geometría</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># gráfico</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">()</span> <span style="color:#6e6a86"># capa geométrica</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">grafico_comunas</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_classic</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/unnamed-chunk-3-1.png" width="768" />
<p>Dado que Chile tiene islas muy alejadas del territorio continental, como Rapa Nui o Juan Fernández, el mapa queda con mucho espacio en blanco. Podemos recortar las coordenadas de la longitud del mapa (el eje <em>x</em> del gráfico) para que el mapa solamente abarque Chile continental:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">grafico_comunas</span> <span style="color:#908caa">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">coord_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">xlim</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">-77</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-65</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_classic</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/unnamed-chunk-4-1.png" width="288" />




<h2 id="mapa-regional-de-chile">Mapa regional de Chile
  <a href="#mapa-regional-de-chile"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>Para generar un mapa de regiones, debemos crear las regiones. Esto no es complicado si pensamos que, en el fondo, las regiones son simplemente la unión de las comunas que las componen. El paquete <code>{sf}</code> simplifica muchísimo el trabajo con datos geográficos, en este caso la unión de distintos polígonos en uno solo.</p>
<p>Agrupamos las filas del dataframe por la variable <code>codigo_region</code>, para que todas las comunas que pertenecen a la misma región estén agrupadas, y usamos <code>summarize()</code> junto a la función <code>sf::st_union()</code> para que los polígonos de las comunas dentro de cada región se combinen, obteniendo polígonos regionales:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_regiones</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa_comunas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">group_by</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_region</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">summarize</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">st_union</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#6e6a86"># resumir los datos agrupados uniéndolos</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_regiones</span>
</span></span></code></pre></div><pre><code># A tibble: 16 × 2
   codigo_region                                                        geometry
   &lt;chr&gt;                                                          &lt;GEOMETRY [°]&gt;
 1 01            POLYGON ((-69.93023 -21.4246, -69.92376 -21.42622, -69.91932 -…
 2 02            MULTIPOLYGON (((-68.0676 -24.32856, -67.91698 -24.26902, -67.8…
 3 03            MULTIPOLYGON (((-71.58497 -29.02456, -71.58844 -29.02838, -71.…
 4 04            MULTIPOLYGON (((-70.54551 -31.30742, -70.53877 -31.30074, -70.…
 5 05            MULTIPOLYGON (((-71.33832 -33.45237, -71.33763 -33.44836, -71.…
 6 06            POLYGON ((-71.5477 -34.87458, -71.54211 -34.87581, -71.53566 -…
 7 07            POLYGON ((-70.41724 -35.63022, -70.41108 -35.6302, -70.40146 -…
 8 08            MULTIPOLYGON (((-73.53466 -36.97378, -73.53245 -36.97829, -73.…
 9 09            MULTIPOLYGON (((-73.35306 -38.73343, -73.35396 -38.72799, -73.…
10 10            MULTIPOLYGON (((-73.1691 -41.87755, -73.16135 -41.87781, -73.1…
11 11            MULTIPOLYGON (((-75.41754 -48.73857, -75.43249 -48.74372, -75.…
12 12            MULTIPOLYGON (((-70.35563 -52.94478, -70.34688 -52.93971, -70.…
13 13            POLYGON ((-70.47405 -33.8624, -70.47327 -33.86269, -70.46068 -…
14 14            MULTIPOLYGON (((-73.39503 -39.88698, -73.39672 -39.89339, -73.…
15 15            POLYGON ((-69.07223 -19.02723, -69.06394 -19.02607, -69.04748 …
16 16            POLYGON ((-72.38553 -36.91169, -72.37685 -36.91617, -72.37034 …
</code></pre>
<p>Obtenemos un dataframe con una fila por región, dado que las comunas fueron unidas en polígonos regionales. La columna <code>geometry</code> ahora contiene la unión de las comunas que hicimos con la función <code>st_union()</code>. Podemos visualizar este nuevo dataframe regional usando <code>{ggplot2}</code> y <code>{sf}</code>, igual que en el paso anterior:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">grafico_regiones</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa_regiones</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">st_set_geometry</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa_regiones</span><span style="color:#908caa">$</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># especificar la geometría del mapa</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># graficar</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># capa geográfica</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">coord_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">xlim</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">-77</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-65</span><span style="color:#908caa">))</span> <span style="color:#6e6a86"># recortar coordenadas</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">grafico_regiones</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_classic</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/unnamed-chunk-6-1.png" width="288" />
<p>Ahora que tenemos nuestros mapas por comunas y por regiones, la idea es poder utilizarlos para visualizar datos en ellos.</p>




<h2 id="visualizar-datos-en-el-mapa">Visualizar datos en el mapa
  <a href="#visualizar-datos-en-el-mapa"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>Para visualizar los datos en un mapa, aplicaremos colores a los distintos polígonos de nuestro mapa, ya sean comunas o regiones. La intensidad del color, o su posición dentro de la escala de color elegida, representará el valor de la variable numérica que queremos visualizar.</p>
<p>La idea de fondo para entender la visualización de datos geográficos por polígonos es entender que los mapas que obtuvimos contienen en cada fila un polígono (la información geográfica para dibujar la comuna o región), y además, en cada fila contienen información que identifica al polígono correspondiente. En nuestro caso, la información de los polígonos corresponde al <em>código único territorial</em> de las comunas, y el código de regiones en el caso de las regiones. Éstos son códigos numéricos que identifican cada unidad territorial del país.</p>
<p>La idea es poder agregarle datos a nuestro mapa, de manera que las filas que representan unidades territoriales tengan también columnas con datos sobre dichas unidades territoriales.</p>
<p>Entonces, deberíamos tener nuestro dataframe con el mapa, y otro dataframe donde tengamos los datos que queremos adjuntar al mapa. Si tenemos un mapa de comunas, tenemos que tener los datos por comuna que queremos agregarle al mapa.</p>




<h3 id="datos-comunales">Datos comunales
  <a href="#datos-comunales"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>




<h4 id="obtener-datos-por-web-scraping">Obtener datos por web scraping
  <a href="#obtener-datos-por-web-scraping"></a>
</h4>
<p>Para visualizar un mapa de datos comunales, primero obtendremos datos comunales desde Wikipedia. Usamos el paquete para hacer un web scraping y obtener una 
<a href="https://es.wikipedia.org/wiki/Anexo:Comunas_de_Chile" target="_blank" rel="noopener">tabla de datos de las comunas del país.</a></p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">rvest</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># dirección de wikipedia con tabla de comunas de Chile</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">url</span> <span style="color:#908caa">&lt;-</span> <span style="color:#f6c177">&#34;https://es.wikipedia.org/wiki/Anexo:Comunas_de_Chile&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># obtener tabla con datos de comunas con web scraping</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">session</span><span style="color:#908caa">(</span><span style="color:#ea9a97">url</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">read_html</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">html_table</span><span style="color:#908caa">(</span><span style="color:#ea9a97">convert</span> <span style="color:#908caa">=</span> <span style="color:#3e8fb0">FALSE</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla[[1]]</span>
</span></span></code></pre></div><pre><code># A tibble: 346 × 12
   CUT (Código Único Territori…¹ Nombre ``    Provincia Región `Superficie(km²)`
   &lt;chr&gt;                         &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;            
 1 15101                         Arica  &quot;&quot;    Arica     Arica… 4.799,4          
 2 15102                         Camar… &quot;&quot;    Arica     Arica… 3.927            
 3 15201                         Putre  &quot;&quot;    Parinaco… Arica… 5.902,5          
 4 15202                         Gener… &quot;&quot;    Parinaco… Arica… 2.244,4          
 5 01101                         Iquiq… &quot;&quot;    Iquique   Tarap… 2.242,1          
 6 01107                         Alto … &quot;&quot;    Iquique   Tarap… 572.9            
 7 01401                         Pozo … &quot;&quot;    Tamarugal Tarap… 13.765,8         
 8 01402                         Camiña &quot;&quot;    Tamarugal Tarap… 2.200,2          
 9 01403                         Colch… &quot;&quot;    Tamarugal Tarap… 4.015,6          
10 01404                         Huara  &quot;&quot;    Tamarugal Tarap… 10.474,6         
# ℹ 336 more rows
# ℹ abbreviated name: ¹​`CUT (Código Único Territorial)`
# ℹ 6 more variables: Población2020 &lt;chr&gt;, `Densidad(hab./km²)` &lt;chr&gt;,
#   `IDH 2005` &lt;chr&gt;, `IDH 2005` &lt;chr&gt;, Latitud &lt;chr&gt;, Longitud &lt;chr&gt;
</code></pre>
<p>Luego obtener los datos, realizamos una pequeña limpieza. Limpiamos los nombres de las variables, seleccionamos las variables que nos interesan, y luego las convertimos apropiadamente a valores numéricos, donde tenemos que eliminar los separadores de miles, y transformar los separadores de decimales a puntos.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">janitor</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">stringr</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># limpiar datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">datos_comunas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla[[1]]</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">clean_names</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># seleccionar y renombrar columnas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_comuna</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cut_codigo_unico_territorial</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">nombre</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">superficie_km2</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">poblacion</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">poblacion2020</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># eliminar espacios de la columna de población</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">poblacion</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_remove_all</span><span style="color:#908caa">(</span><span style="color:#ea9a97">poblacion</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34; &#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">poblacion</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.numeric</span><span style="color:#908caa">(</span><span style="color:#ea9a97">poblacion</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># eliminar los separadores de miles</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">superficie_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_remove_all</span><span style="color:#908caa">(</span><span style="color:#ea9a97">superficie_km2</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;\\.&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>         <span style="color:#6e6a86"># convertir comas a puntos</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">superficie_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_replace</span><span style="color:#908caa">(</span><span style="color:#ea9a97">superficie_km2</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">superficie_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.numeric</span><span style="color:#908caa">(</span><span style="color:#ea9a97">superficie_km2</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">datos_comunas</span>
</span></span></code></pre></div><pre><code># A tibble: 346 × 5
   codigo_comuna nombre        region             superficie_km2 poblacion
   &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;
 1 15101         Arica         Arica y Parinacota          4799.    247552
 2 15102         Camarones     Arica y Parinacota          3927       1233
 3 15201         Putre         Arica y Parinacota          5902.      2515
 4 15202         General Lagos Arica y Parinacota          2244.       810
 5 01101         Iquique       Tarapacá                    2242.    223463
 6 01107         Alto Hospicio Tarapacá                    5729     129999
 7 01401         Pozo Almonte  Tarapacá                   13766.     17395
 8 01402         Camiña        Tarapacá                    2200.      1375
 9 01403         Colchane      Tarapacá                    4016.      1583
10 01404         Huara         Tarapacá                   10475.      3000
# ℹ 336 more rows
</code></pre>
<p>Ahora que tenemos una tabla de datos que contiene la columna <code>codigo_comuna</code> con el código único territorial de las comunas, podemos unirla al mapa de comunas.</p>




<h4 id="agregar-datos-a-los-mapas-con-left_join">Agregar datos a los mapas con <code>left_join()</code>
  <a href="#agregar-datos-a-los-mapas-con-left_join"></a>
</h4>
<p>Esta operación de unir dos tablas de datos diferentes, pero que coinciden en una columna en común, se realiza con la función <code>left_join()</code>. El principio de <code>left_join()</code> es que tenemos dos tablas de datos, y ambas tablas de datos tienen una misma columna, que poseen los mismos valores (en nuestro caso, una columna con las comunas o los códigos únicos territoriales de las comunas). Entonces, ambas tablas se van a unir según la correspondencias de estas columnas en común.</p>
<p><em>Ejemplo:</em></p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_a</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tribble</span><span style="color:#908caa">(</span><span style="color:#908caa">~</span><span style="color:#ea9a97">animal</span><span style="color:#908caa">,</span>   <span style="color:#908caa">~</span><span style="color:#ea9a97">favorito</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                   <span style="color:#f6c177">&#34;gato&#34;</span><span style="color:#908caa">,</span>    <span style="color:#f6c177">&#34;pescado&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                   <span style="color:#f6c177">&#34;mapache&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;basura&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                   <span style="color:#f6c177">&#34;perro&#34;</span><span style="color:#908caa">,</span>   <span style="color:#f6c177">&#34;carne&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_b</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tribble</span><span style="color:#908caa">(</span><span style="color:#908caa">~</span><span style="color:#ea9a97">animal</span><span style="color:#908caa">,</span>   <span style="color:#908caa">~</span><span style="color:#ea9a97">belleza</span><span style="color:#908caa">,</span> <span style="color:#908caa">~</span><span style="color:#ea9a97">inteligencia</span><span style="color:#908caa">,</span> <span style="color:#908caa">~</span><span style="color:#ea9a97">carisma</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                   <span style="color:#f6c177">&#34;gato&#34;</span><span style="color:#908caa">,</span>    <span style="color:#f6c177">8</span><span style="color:#908caa">,</span>        <span style="color:#f6c177">6</span><span style="color:#908caa">,</span>             <span style="color:#f6c177">5</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                   <span style="color:#f6c177">&#34;perro&#34;</span><span style="color:#908caa">,</span>   <span style="color:#f6c177">5</span><span style="color:#908caa">,</span>        <span style="color:#f6c177">2</span><span style="color:#908caa">,</span>             <span style="color:#f6c177">8</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                   <span style="color:#f6c177">&#34;mapache&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">10</span><span style="color:#908caa">,</span>       <span style="color:#f6c177">7</span><span style="color:#908caa">,</span>             <span style="color:#f6c177">2</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">left_join</span><span style="color:#908caa">(</span><span style="color:#ea9a97">tabla_a</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">tabla_b</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">by</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;animal&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><pre><code># A tibble: 3 × 5
  animal  favorito belleza inteligencia carisma
  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;
1 gato    pescado        8            6       5
2 mapache basura        10            7       2
3 perro   carne          5            2       8
</code></pre>
<p>En el ejemplo, tenemos dos tablas, donde las dos tienen una misma columna con los mismos datos, y otras columnas con datos distintos. Usando <code>left_join()</code> podemos unir ambas tablas de datos a partir de la columna que tienen en común. Como resultado obtenemos una nueva tabla que tiene todas las columnas.</p>
<hr>
<p>Procedemos a unir los datos con el mapa usando <code>left_join()</code>, especificando en el argumento <code>by</code> que la unión sea a partir de la columna <code>codigo_comuna</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_comunas_2</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa_comunas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># adjuntar datos al mapa, coincidiendo por columna de código de comunas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">left_join</span><span style="color:#908caa">(</span><span style="color:#ea9a97">datos_comunas</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">by</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">join_by</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_comuna</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">relocate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">.after</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">)</span> <span style="color:#6e6a86"># tirar geometría al final</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_comunas_2</span>
</span></span></code></pre></div><pre><code># A tibble: 345 × 8
   codigo_comuna codigo_provincia codigo_region nombre     region superficie_km2
   &lt;chr&gt;         &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;
 1 01401         014              01            Pozo Almo… Tarap…         13766.
 2 01403         014              01            Colchane   Tarap…          4016.
 3 01405         014              01            Pica       Tarap…          8934.
 4 01402         014              01            Camiña     Tarap…          2200.
 5 01404         014              01            Huara      Tarap…         10475.
 6 01107         011              01            Alto Hosp… Tarap…          5729 
 7 01101         011              01            Iquique    Tarap…          2242.
 8 02104         021              02            Taltal     Antof…         20405.
 9 02101         021              02            Antofagas… Antof…         30718.
10 02201         022              02            Calama     Antof…         15597.
# ℹ 335 more rows
# ℹ 2 more variables: poblacion &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [°]&gt;
</code></pre>
<p>Como resultado, tenemos un nuevo dataframe que además de tener los datos geográficos de las comunas, también tiene nuevas columnas con datos que podemos visualizar.</p>




<h4 id="visualizar-datos-comunales">Visualizar datos comunales
  <a href="#visualizar-datos-comunales"></a>
</h4>
<p>Para visualizar datos comunales en un mapa, especificamos la columna de geometría que contiene la información geográfica, y creamos un gráfico de <code>{ggplot2}</code>. En este gráfico, especificamos que el relleno de los polígonos (<code>fill</code>) se haga a partir de una de las variables numéricas.</p>
<p>Usamos la función <code>geom_sf()</code> para agregar una capa de geometría a nuestro gráfico que contenga los polígonos territoriales de las comunas. Luego, definimos un tema, una paleta de colores, y corregimos la escala del eje horizontal.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_comunas_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">st_set_geometry</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa_comunas_2</span><span style="color:#908caa">$</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># asignar geometría</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># gráfico</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">poblacion</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">linewidth</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># capa geométrica</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_classic</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">scale_fill_distiller</span><span style="color:#908caa">(</span><span style="color:#ea9a97">type</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;seq&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">12</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                       <span style="color:#ea9a97">labels</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">label_comma</span><span style="color:#908caa">(</span><span style="color:#ea9a97">big.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># colores</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">scale_x_continuous</span><span style="color:#908caa">(</span><span style="color:#ea9a97">breaks</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">seq</span><span style="color:#908caa">(</span><span style="color:#f6c177">-76</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-65</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">length.out</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">3</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#ea9a97">floor</span><span style="color:#908caa">())</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># escala x</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">coord_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">xlim</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">-77</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-65</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># recortar coordenadas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme</span><span style="color:#908caa">(</span><span style="color:#ea9a97">legend.key.width</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">unit</span><span style="color:#908caa">(</span><span style="color:#f6c177">3</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;mm&#34;</span><span style="color:#908caa">))</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/unnamed-chunk-11-1.png" width="288" />
<p>Como resultado obtenemos un mapa coroplético, o mapa de coropletas, que es un mapa donde cada región o polígono está relleno de un color que representa un valor en una escala de una variable.</p>
<p>Acá hacemos otro mapa, usando el mismo código y simplemente cambiando la variable de relleno de los polígonos territoriales:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_comunas_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">st_set_geometry</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa_comunas_2</span><span style="color:#908caa">$</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">superficie_km2</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># variable de relleno</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">linewidth</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_classic</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">scale_fill_distiller</span><span style="color:#908caa">(</span><span style="color:#ea9a97">type</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;seq&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">11</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#ea9a97">labels</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">label_comma</span><span style="color:#908caa">(</span><span style="color:#ea9a97">big.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">scale_x_continuous</span><span style="color:#908caa">(</span><span style="color:#ea9a97">breaks</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">seq</span><span style="color:#908caa">(</span><span style="color:#f6c177">-76</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-65</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">length.out</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">3</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#ea9a97">floor</span><span style="color:#908caa">())</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">coord_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">xlim</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">-77</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-65</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme</span><span style="color:#908caa">(</span><span style="color:#ea9a97">legend.key.width</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">unit</span><span style="color:#908caa">(</span><span style="color:#f6c177">3</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;mm&#34;</span><span style="color:#908caa">))</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/unnamed-chunk-12-1.png" width="288" />




<h4 id="mapa-de-una-sola-región-por-comunas">Mapa de una sola región, por comunas
  <a href="#mapa-de-una-sola-regi%c3%b3n-por-comunas"></a>
</h4>
<p>Si queremos visualizar una sola región del país, subdividida por comunas, tan sencillo como agregar un filtro a los datos que filtre las filas que pertenecen a la región que nos interesa. En este caso, vamos a visualizar la población por comunas de la región del Libertador General Bernardo O&rsquo;Higgins:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># filtrar datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_comunas_filtro</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa_comunas_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_region</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;06&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># mapa</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_comunas_filtro</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">st_set_geometry</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa_comunas_filtro</span><span style="color:#908caa">$</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">poblacion</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">linewidth</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0.12</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">label</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">comma</span><span style="color:#908caa">(</span><span style="color:#ea9a97">poblacion</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">big.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">)),</span> 
</span></span><span style="display:flex;"><span>               <span style="color:#ea9a97">size</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">2</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">check_overlap</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">T</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_classic</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">scale_fill_distiller</span><span style="color:#908caa">(</span><span style="color:#ea9a97">type</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;seq&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">12</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#ea9a97">labels</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">label_comma</span><span style="color:#908caa">(</span><span style="color:#ea9a97">big.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme</span><span style="color:#908caa">(</span><span style="color:#ea9a97">legend.key.width</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">unit</span><span style="color:#908caa">(</span><span style="color:#f6c177">3</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;mm&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme</span><span style="color:#908caa">(</span><span style="color:#ea9a97">axis.title</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">element_blank</span><span style="color:#908caa">())</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/unnamed-chunk-13-1.png" width="576" />
<p>En este caso, agregamos también la función <code>geom_sf_text()</code> para agregar una capa nuestro gráfico que contiene las cifras para cada comuna. Hay que tener en consideración que poner números o textos sobre mapas suele ser complejo, porque el mapa ya es denso visualmente, y agregarle texto puede hacer que se vuelva ilegible. Hay que tener especial cuidado en resolver situaciones como textos que pasan por encima de bordes en el mapa, que se ubican incorrectamente dentro de los polígonos, o que se sobreponen uno sobre otros debido a que los polígonos se ven muy pequeños dentro del mapa.</p>
<hr>




<h3 id="datos-regionales">Datos regionales
  <a href="#datos-regionales"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>




<h4 id="obtener-datos-por-web-scraping-1">Obtener datos por web scraping
  <a href="#obtener-datos-por-web-scraping-1"></a>
</h4>
<p>Para hacer el ejemplo de visualizar datos a nivel regional, nuevamente obtendremos datos a esta escala usando web scraping. Obtendremos una tabla del Producto Interno Bruto regional desde el 
<a href="https://si3.bcentral.cl/Siete/ES/Siete/Cuadro/CAP_CCNN/MN_CCNN76/CCNN2018_PIB_REGIONAL_N/637899740344107786" target="_blank" rel="noopener">sitio web de el Banco Central de Chile.</a></p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">rvest</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># dirección del sitio del banco central</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">url</span> <span style="color:#908caa">&lt;-</span> <span style="color:#f6c177">&#34;https://si3.bcentral.cl/Siete/ES/Siete/Cuadro/CAP_CCNN/MN_CCNN76/CCNN2018_PIB_REGIONAL_N/637899740344107786&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># obtener tabla con datos de comunas con web scraping</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">session</span><span style="color:#908caa">(</span><span style="color:#ea9a97">url</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">read_html</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">html_table</span><span style="color:#908caa">(</span><span style="color:#ea9a97">convert</span> <span style="color:#908caa">=</span> <span style="color:#3e8fb0">FALSE</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><p>Limpiamos los datos seleccionando las columnas que necesitamos, transformando la columna a tipo numérico, y filtrando las filas para quedar solamente con las que corresponden a las regiones de Chile:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">datos_regiones</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pib</span> <span style="color:#ea9a97">[[1]]</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">janitor</span><span style="color:#908caa">::</span><span style="color:#ea9a97">clean_names</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">serie</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">pib</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">x2023</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">pib</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_remove_all</span><span style="color:#908caa">(</span><span style="color:#ea9a97">pib</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;\\.&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">pib</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.numeric</span><span style="color:#908caa">(</span><span style="color:#ea9a97">pib</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Región&#34;</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">datos_regiones</span>
</span></span></code></pre></div><pre><code># A tibble: 16 × 2
   region                                                 pib
   &lt;chr&gt;                                                &lt;dbl&gt;
 1 Región de Arica y Parinacota                          2169
 2 Región de Tarapacá                                    7892
 3 Región de Antofagasta                                31290
 4 Región de Atacama                                     6004
 5 Región de Coquimbo                                    9174
 6 Región de Valparaíso                                 20275
 7 Región Metropolitana de Santiago                    109143
 8 Región del Libertador General Bernardo OHiggins      11910
 9 Región del Maule                                     10348
10 Región de Ñuble                                       4106
11 Región del Biobío                                    16731
12 Región de La Araucanía                                7743
13 Región de Los Ríos                                    3561
14 Región de Los Lagos                                   9432
15 Región de Aysén del General Carlos Ibáñez del Campo   1573
16 Región de Magallanes y de la Antártica Chilena        2490
</code></pre>




<h4 id="crear-columna-de-códigos-regionales">Crear columna de códigos regionales
  <a href="#crear-columna-de-c%c3%b3digos-regionales"></a>
</h4>
<p>Los datos que obtuvimos no contienen una variable con el código único territorial de las regiones, dado que es un dato que está en desuso desde la promulgación de una ley en 2018 que prohíbe el uso de los números en comunicaciones públicas. Sin embargo, en muchas base de datos oficiales se sigue usando la numeración de las regiones, principalmente para evitar problemas de diferencias en los nombres de las regiones, por ejemplo, si contienen o no las palabras <em>Región de</em> o <em>Región del</em> para cada región, si contienen tildes o no, si contienen abreviaciones o no, si contienen símbolos como <em>eñes</em> o apóstrofes, etc. Todos estos problemas son resueltos por el uso de identificador numérico de las regiones.</p>
<p>Como el mapa que obtuvimos con el paquete <code>{chilemapas}</code> utiliza el código regional, en el dato frente de nuestros datos crearemos una columna con los mismos códigos regionales, asignados a cada región a partir de la coincidencia con los textos. Por ejemplo, si el texto del nombre de la región contiene la palabra <em>Arica</em>, se le asigna el código <code>15</code>. Esta forma de asignar los códigos regionales puede ser inexacta, pero es muy sencillo confirmar si es que la asignación de códigos funciona correctamente, y también siempre es posible utilizar 
<a href="https://stringr.tidyverse.org/articles/regular-expressions.html" target="_blank" rel="noopener">expresiones regulares en <code>{stringr}</code></a> para hacer coincidencias más flexibles, como por ejemplo, coincidir una palabra con un código sin importar si la palabra tiene o no tilde, o está mal escrita.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">datos_regiones_2</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">datos_regiones</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_region</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">case_when</span><span style="color:#908caa">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Arica&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">15</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Tarapacá&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">1</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Antofagasta&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">2</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Atacama&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">3</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Coquimbo&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">4</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Valparaíso&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">5</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Metropolitana&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">13</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Libertador General&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">6</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Maule&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">7</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Ñuble&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">16</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Biobío&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">8</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Araucanía&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">9</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Los Ríos&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">14</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Los Lagos&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">10</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Aysén&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">11</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Magallanes&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">12</span>
</span></span><span style="display:flex;"><span>  <span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">rename</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_region</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">region</span><span style="color:#908caa">)</span>
</span></span></code></pre></div>



<h4 id="unir-datos-con-mapa">Unir datos con mapa
  <a href="#unir-datos-con-mapa"></a>
</h4>
<p>Luego de crear la variable de códigos regionales, podemos hacer la unión entre ambas tablas de datos, mapas y datos regionales, usando <code>left_join()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_regiones_2</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa_regiones</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_region</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.numeric</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_region</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">left_join</span><span style="color:#908caa">(</span><span style="color:#ea9a97">datos_regiones_2</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">by</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">join_by</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_region</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">relocate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">.after</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">)</span> <span style="color:#6e6a86"># tirar columna al final</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_regiones_2</span>
</span></span></code></pre></div><pre><code># A tibble: 16 × 4
   codigo_region nombre_region                     pib                  geometry
           &lt;dbl&gt; &lt;chr&gt;                           &lt;dbl&gt;            &lt;GEOMETRY [°]&gt;
 1             1 Región de Tarapacá               7892 POLYGON ((-69.93023 -21.…
 2             2 Región de Antofagasta           31290 MULTIPOLYGON (((-68.0676…
 3             3 Región de Atacama                6004 MULTIPOLYGON (((-71.5849…
 4             4 Región de Coquimbo               9174 MULTIPOLYGON (((-70.5455…
 5             5 Región de Valparaíso            20275 MULTIPOLYGON (((-71.3383…
 6             6 Región del Libertador General…  11910 POLYGON ((-71.5477 -34.8…
 7             7 Región del Maule                10348 POLYGON ((-70.41724 -35.…
 8             8 Región del Biobío               16731 MULTIPOLYGON (((-73.5346…
 9             9 Región de La Araucanía           7743 MULTIPOLYGON (((-73.3530…
10            10 Región de Los Lagos              9432 MULTIPOLYGON (((-73.1691…
11            11 Región de Aysén del General C…   1573 MULTIPOLYGON (((-75.4175…
12            12 Región de Magallanes y de la …   2490 MULTIPOLYGON (((-70.3556…
13            13 Región Metropolitana de Santi… 109143 POLYGON ((-70.47405 -33.…
14            14 Región de Los Ríos               3561 MULTIPOLYGON (((-73.3950…
15            15 Región de Arica y Parinacota     2169 POLYGON ((-69.07223 -19.…
16            16 Región de Ñuble                  4106 POLYGON ((-72.38553 -36.…
</code></pre>




<h4 id="visualizar-datos-regionales">Visualizar datos regionales
  <a href="#visualizar-datos-regionales"></a>
</h4>
<p>Finalmente, visualizamos los datos en un mapa regional de la misma forma que lo hicimos con los mapas comunales. Esta vez, el mapa y los datos vienen en una fila por región, con la variable <code>geometry</code> que conteniendo la geometría del polígono regional. Por tanto, el código es exactamente el mismo, y solamente cambia el dataframe que usamos para generar el gráfico:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_regiones_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">st_set_geometry</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa_regiones_2</span><span style="color:#908caa">$</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># asignar geometría</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># gráfico</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pib</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">linewidth</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0.12</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># capa geométrica</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_classic</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">scale_fill_distiller</span><span style="color:#908caa">(</span><span style="color:#ea9a97">type</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;seq&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">18</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#ea9a97">labels</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">label_comma</span><span style="color:#908caa">(</span><span style="color:#ea9a97">big.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">scale_x_continuous</span><span style="color:#908caa">(</span><span style="color:#ea9a97">breaks</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">seq</span><span style="color:#908caa">(</span><span style="color:#f6c177">-76</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-65</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">length.out</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">3</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#ea9a97">floor</span><span style="color:#908caa">())</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">coord_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">expand</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">F</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">xlim</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">-77</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-65</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span> <span style="color:#6e6a86"># recortar coordenadas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme</span><span style="color:#908caa">(</span><span style="color:#ea9a97">legend.key.width</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">unit</span><span style="color:#908caa">(</span><span style="color:#f6c177">3</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;mm&#34;</span><span style="color:#908caa">))</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/unnamed-chunk-18-1.png" width="288" />
<hr>
<p>Visualizar datos geográficamente es una herramienta de comunicación y análisis de datos muy potente. Personalmente, encuentro que el potencial de la visualización de datos en mapas radica mucho más allá de simplemente mapear una variable a un territorio, sino a crear el incentivo para que la persona que ve el mapa analice el mapa en relación a todo el conjunto de conocimientos que tenemos acerca del espacio que habitamos, sus características sociales, y las desigualdades distribuidas en el territorio.</p>
<hr>
<p>Si este tutorial te sirvió, por favor considera hacerme una pequeña donación para poder tomarme un cafecito mientras escribo el siguiente tutorial 🥺</p>
<div style = "height: 18px;">
</div>
<div>
  <div style="display: flex;
  justify-content: center;
  align-items: center;">
    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="bastimapache" data-color="#FFDD00" data-emoji="☕"  data-font="Cookie" data-text="Regálame un cafecito" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff" ></script>
  </div>

        
        <details closed class="f6 fw7 input-reset">
  <dl class="f6 lh-copy">
    <dt class="fw7">Fecha de publicación:</dt>
    <dd class="fw5 ml0">November 25, 2024</dd>
  </dl>
  <dl class="f6 lh-copy">
    <dt class="fw7">Extensión:</dt>
    <dd class="fw5 ml0">16 minute read, 3301 words</dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Categorías:</dt>
    <dd class="fw5 ml0"> <a href="http://localhost:4321/categories/tutoriales">tutoriales</a> </dd>
  </dl>
  
  
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Tags:</dt>
    <dd class="fw5 ml0"> <a href="http://localhost:4321/tags/mapas">mapas</a>  <a href="http://localhost:4321/tags/ggplot2">ggplot2</a>  <a href="http://localhost:4321/tags/gr%C3%A1ficos">gráficos</a>  <a href="http://localhost:4321/tags/ciencias-sociales">ciencias sociales</a>  <a href="http://localhost:4321/tags/visualizaci%C3%B3n-de-datos">visualización de datos</a> </dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Ver también:</dt>
    
    <dd class="fw5 ml0"><a href="/blog/unim/presentacion_visualizador_datos_corrupcion/">Video: Presentación de Visualizador de datos de Corrupción en Chile</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/2025-01-14/">Actualización de app Análisis de prensa: visualización de análisis de sentimiento de noticias recientes</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/camcorder/">Graba el proceso de tus visualizaciones de datos con {camcorder}</a></dd>
    
  </dl>
</details>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="http://localhost:4321/blog/portafolio_trabajos_r/">&larr; Portafolio de trabajos previos en R</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="http://localhost:4321/blog/surveydown_encuestas/">Crea encuestas en R usando {surveydown} &rarr;</a>
  
</div>

      </footer>
    </article>
    
      <div class="post-comments pa0 pa4-l mt4">
  
    
      <script src="https://utteranc.es/client.js"
              repo="bastianolea/blog-bastianolea-r"
              issue-term="pathname"
              theme="github-light"
              label="comments"
              crossorigin="anonymous"
              async
              type="text/javascript">
      </script>
    
  
</div>

    
  </section>
</main>
<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2025 Bastián Olea Herrera, Chile
      <span class="middot-divider"></span>
      Hecho con <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Basado en <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span>, de <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/bastianolea" title="github" target="_blank" rel="me noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://bsky.app/profile/bastianolea.rbind.io" title="bluesky" target="_blank" rel="me noopener">
      <i class="fab fa-bluesky fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://x.com/bastimapache" title="twitter" target="_blank" rel="me noopener">
      <i class="fab fa-twitter fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.linkedin.com/in/bastianolea/" title="linkedin" target="_blank" rel="me noopener">
      <i class="fab fa-linkedin fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.tiktok.com/@bastimapache" title="tiktok" target="_blank" rel="me noopener">
      <i class="fab fa-tiktok fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/raccunnie" title="instagram" target="_blank" rel="me noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.goodreads.com/user/show/53224910-basti-n-olea-herrera" title="goodreads" target="_blank" rel="me noopener">
      <i class="fab fa-goodreads fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="/contact/" title="envelope" >
      <i class="fas fa-envelope fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/about/" title="Bastián Olea: Sobre mi">Sobre mi</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Bastián Olea: Contacto">Contacto</a>
      
      <a class="dib pv1 ph2 link" href="/license/" title="Bastián Olea: Licencia">Licencia</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>

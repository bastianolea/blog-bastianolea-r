<!DOCTYPE html>
<html lang="es-ES" dir="ltr"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.136.5">
<title>Tutorial: generar tablas atractivas y personalizables con {gt} | Blog</title>


<meta property="twitter:site" content="@bastimapache">
<meta property="twitter:creator" content="@bastimapache">







  
    
  
<meta name="description" content="El paquete de R `{gt}` genera tablas para presentar tus datos. Produce tablas atractivas con muy pocas líneas de código, y al mismo tiempo ofrece una alta capacidad de personalización de las tablas. En este artículo te mostraré tres ejemplos de creación de distintas tablas basadas en datos reales.">


<meta property="og:site_name" content="Blog">
<meta property="og:title" content="Tutorial: generar tablas atractivas y personalizables con {gt} | Blog">
<meta property="og:description" content="El paquete de R `{gt}` genera tablas para presentar tus datos. Produce tablas atractivas con muy pocas líneas de código, y al mismo tiempo ofrece una alta capacidad de personalización de las tablas. En este artículo te mostraré tres ejemplos de creación de distintas tablas basadas en datos reales." />
<meta property="og:type" content="page" />
<meta property="og:url" content="http://localhost:4321/blog/tutorial_gt/" />
<meta property="og:locale" content="es-ES">




    
        <meta property="og:image" content="http://localhost:4321/blog/sidebar-listing.png" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="http://localhost:4321/blog/sidebar-listing.png" >
    
    
  
  <meta itemprop="name" content="Tutorial: generar tablas atractivas y personalizables con {gt}">
  <meta itemprop="description" content="El paquete de R {gt} (llamado así por generar great tables) permite producir tablas atractivas con R para presentar tus datos. Sus cualidades principales son que produce resultados atractivos con muy pocas líneas de código, pero al mismo tiempo ofrece una alta capacidad de personalización, teniendo opciones para personalizar prácticamente todos los aspectos de la tabla.
Otro beneficio de usar este paquete es que contiene funciones que hacen muy fácil darle el formato correcto a las variables numéricas, como porcentajes, números grandes, cifras en dinero, etc., Y además, ofrece funciones para darle estilos personalizados a las columnas o celdas de tu tabla de forma programática. Esto permite generar ciertas reglas para que las celdas cambien de colores dependiendo de su valor, ciertas cifras cambian su tipo de letra bajo determinadas circunstancias, y mucho más.">
  <meta itemprop="datePublished" content="2024-11-19T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-11-19T00:00:00+00:00">
  <meta itemprop="wordCount" content="5562">
  <meta itemprop="keywords" content="Tablas,Web scraping,Chile">
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.c4fbf76e54adf7e7a1073b995dfaf4f393e11c67c30cfd5b19d29824f2cee0f0.css" integrity="sha256-xPv3blSt9&#43;ehBzuZXfr085PhHGfDDP1bGdKYJPLO4PA=" media="screen">
  
  
  <script src="/panelset.min.ed1ac24b6e16f4e2481e3d1d098ae66f5bc77438aef619e6e266d8ac5b00dc72.js" type="text/javascript"></script>
  
  
  <script src="/main.min.26a7606c1bee1310cdae7196cfade9ba0a2a95bff0c4f9cc2156609ec0d0326a.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="http://localhost:4321/" title="Home">
      <img src="/img/logo.png" class="dib db-l h2 w-auto" alt="Blog">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/blog/" title="Bastián Olea: Blog de R">Blog R</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/apps/" title="Bastián Olea: Apps">Apps</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/clases/" title="Bastián Olea: Clases">Clases</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/tags/" title="Bastián Olea: Blog">Temas</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/categories/tutoriales/" title="Bastián Olea: Tutoriales">Tutoriales</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/blog/r_introduccion/" title="Bastián Olea: Tutoriales">Intro a R</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="Bastián Olea: Sobre mi">Yo</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/contact/" title="Bastián Olea: Contacto">Contacto</a>
      
      
      <div class="dib v-mid">
        <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/bastianolea" title="github" target="_blank" rel="me noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://x.com/bastimapache" title="twitter" target="_blank" rel="me noopener">
      <i class="fab fa-twitter fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://bsky.app/profile/bastianolea.rbind.io" title="bluesky" target="_blank" rel="me noopener">
      <i class="fab fa-bluesky fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.linkedin.com/in/bastianolea/" title="linkedin" target="_blank" rel="me noopener">
      <i class="fab fa-linkedin fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/raccunnie" title="instagram" target="_blank" rel="me noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.goodreads.com/user/show/53224910-basti-n-olea-herrera" title="goodreads" target="_blank" rel="me noopener">
      <i class="fab fa-goodreads fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="/contact/" title="envelope" >
      <i class="fas fa-envelope fa-lg fa-fw"></i>
    </a>
  
</div>

      </div>
      
    </div>
  </nav>
</header>

<main class="page-main pa4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 ph4-l">
      <header class="post-header">
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">Tutorial: generar tablas atractivas y personalizables con {gt}</h1>
        
        
        <p class="f7 db mv0 ttu">19/11/2024</p>
        
        
        
  <dl class="f6 lh-copy">
    <em><dd class="fw5 ml0">Temas:  <a href="http://localhost:4321/tags/tablas">tablas</a>  <a href="http://localhost:4321/tags/web-scraping">web scraping</a>  <a href="http://localhost:4321/tags/chile">Chile</a> </dd></em>
  </dl>


        
      

      </header>
      <section class="post-body pt5 pb4">
        <p>
<a href="https://gt.rstudio.com" target="_blank" rel="noopener">El paquete de R <code>{gt}</code></a> (llamado así por generar <em>great tables</em>) permite producir tablas atractivas con R para presentar tus datos. Sus cualidades principales son que produce <strong>resultados atractivos con muy pocas líneas de código</strong>, pero al mismo tiempo ofrece una <strong>alta capacidad de personalización</strong>, teniendo opciones para personalizar prácticamente todos los aspectos de la tabla.</p>
<p>Otro beneficio de usar este paquete es que contiene funciones que hacen muy fácil darle el <strong>formato correcto a las variables numéricas,</strong> como porcentajes, números grandes, cifras en dinero, etc., Y además, ofrece funciones para darle estilos personalizados a las columnas o celdas de tu tabla de forma programática. Esto permite generar ciertas reglas para que las <strong>celdas cambien de colores dependiendo de su valor</strong>, ciertas cifras <strong>cambian su tipo de letra bajo determinadas circunstancias</strong>, y mucho más.</p>
<p>En este artículo te mostraré tres ejemplos de creación de distintas tablas basadas en datos reales:</p>
<ol>
<li>Tabla de <strong>estimación de pobreza comunal</strong>, con estilo condicional de celdas y columnas con colorización en base a datos</li>
<li>Tabla de <strong>resultados electorales</strong>, con colorización de celdas de variables categóricas en base a una segunda variable categórica</li>
<li>Tabla de <strong>Producto Interno Bruto regional</strong>, con colorización de múltiples columnas numéricas de forma simultánea, y estilo de celdas condicional</li>
</ol>
<hr>




<h2 id="tabla-de-estimación-de-pobreza-por-comunas">Tabla de estimación de pobreza por comunas
  <a href="#tabla-de-estimaci%c3%b3n-de-pobreza-por-comunas"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>El primer ejemplo de tabla se basará en los datos de 
<a href="https://bidat.midesof.cl/directorio/Pobreza%20comunal/estimaciones-de-pobreza-comunal-2022" target="_blank" rel="noopener">estimaciones de pobreza comunal del año 2022, producidos por el Ministerio de Desarrollo Social</a> de Chile.</p>
<p>El primer paso será 
<a href="https://bidat.midesof.cl/directorio/Pobreza%20comunal/estimaciones-de-pobreza-comunal-2022" target="_blank" rel="noopener">obtener los datos oficiales.</a> Por conveniencia, tengo la tabla con los datos originales pre-procesada 
<a href="https://github.com/bastianolea/pobreza_chile" target="_blank" rel="noopener">en un repositorio sobre datos de pobreza en Chile</a>, por lo que es posible importar los datos limpios en una sola línea de código:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">pobreza</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">readr</span><span style="color:#908caa">::</span><span style="color:#ea9a97">read_csv2</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;https://raw.githubusercontent.com/bastianolea/pobreza_chile/refs/heads/main/pobreza_comunal/datos_procesados/pobreza_comunal.csv&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">pobreza</span>
</span></span></code></pre></div><pre><code># A tibble: 345 × 8
   codigo region     nombre_comuna poblacion pobreza_n pobreza_p limite_inferior
    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;           &lt;dbl&gt;
 1   1101 Tarapacá   Iquique          229674    41967.     0.183          0.162 
 2   1107 Tarapacá   Alto Hospicio    138527    45162.     0.326          0.295 
 3   1401 Tarapacá   Pozo Almonte      18290     4563.     0.250          0.199 
 4   1402 Tarapacá   Camiña             1380      308.     0.223          0.138 
 5   1403 Tarapacá   Colchane           1575      473.     0.300          0.187 
 6   1404 Tarapacá   Huara              3072     1185.     0.386          0.319 
 7   1405 Tarapacá   Pica               6184     1040.     0.168          0.119 
 8   2101 Antofagas… Antofagasta      438942    73103.     0.167          0.141 
 9   2102 Antofagas… Mejillones        15502     3078.     0.199          0.127 
10   2103 Antofagas… Sierra Gorda       1790      295.     0.165          0.0743
# ℹ 335 more rows
# ℹ 1 more variable: limite_superior &lt;dbl&gt;
</code></pre>
<p>Podemos ver que los datos corresponden a 345 filas con información de las comunas, su población, y las cifras de pobreza en números absolutos y porcentaje.</p>
<p>Para el ejemplo, primero obtendremos 7 filas al azar y seleccionaremos solamente las columnas que nos interesan. Teniendo cualquier tabla de datos en R, si le agregamos la función <code>gt()</code> crearemos una tabla <code>{gt}</code> con las configuraciones por defecto:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">dplyr</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">gt</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">set.seed</span><span style="color:#908caa">(</span><span style="color:#f6c177">1917</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pobreza_1</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">pobreza</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">slice_sample</span><span style="color:#908caa">(</span><span style="color:#ea9a97">n</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">7</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">contains</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;comuna&#34;</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">poblacion</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">starts_with</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;pobreza&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">gt</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pobreza_1.png"/>
</div>
<p>Esta es la tabla básica que entrega <code>{gt}</code>, la cual viene con líneas horizontales elegantes y un espaciado de celdas agradable. Tiene una apariencia bastante mejor que haber pegado a los datos en una planilla de Excel 🤫</p>




<h3 id="formato-de-variables-numéricas">Formato de variables numéricas
  <a href="#formato-de-variables-num%c3%a9ricas"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>El primer paso para mejorar esta tabla es darle un formato de texto correcto a las variables numéricas. Esto logramos con las funciones de <code>{gt}</code> que empiezan con <code>fmt_</code> (por <em>formato</em>), de las cuales usaremos <code>fmt_number()</code> para remover decimales de los números enteros y aplicar separadores de miles, y <code>fmt_percent()</code> para especificar el número de decimales y usar la coma como separador de decimales.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pobreza_2</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pobreza_1</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># dar formato a números enteros</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">fmt_number</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#ea9a97">poblacion</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">pobreza_n</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">decimals</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">sep_mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># dar formato a porcentajes</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">fmt_percent</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pobreza_p</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">decimals</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">1</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">drop_trailing_zeros</span> <span style="color:#908caa">=</span> <span style="color:#3e8fb0">TRUE</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">dec_mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pobreza_2.png"/>
</div>




<h3 id="apariencia-de-columnas">Apariencia de columnas
  <a href="#apariencia-de-columnas"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>El segundo paso va a ser cambiar el formato del texto de algunas columnas. En este caso, queremos aplicar letras negrita a la columna <code>nombre_comuna</code>, Y vamos a alinear la columna <code>region</code> hacia la derecha, para que se pegue al nombre de las comunas. Esto se lleva a cabo con la función <code>tab_style()</code>, cuyo primer argumento es el estilo que vamos a darle a las celdas, y el segundo es las columnas o filas que vamos a afectar. Cómo vamos a cambiar el texto de las celdas, en el argumento <code>style</code> se usa la función <code>cell_text()</code>, que contiene todos los atributos que podemos cambiar de las letras de las celdas, como color, tamaño, estilo, peso, etc.</p>
<p>La alineación del texto también podríamos haberla hecho con la función <code>tab_style()</code>, especificando en <code>cell_text()</code> que queremos que el texto sea alienado a la derecha, pero <code>{gt}</code> nos facilita un poco ésto con la función <code>cols_align()</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pobreza_3</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pobreza_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># cambiar estilo de texto de una columna</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">weight</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;bold&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># alineación de texto de una columna</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_align</span><span style="color:#908caa">(</span><span style="color:#ea9a97">align</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;right&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">region</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pobreza_3.png"/>
</div>
<p>Para terminar de cambiar las configuraciones básicas de nuestra tabla, tenemos que mejorar los nombres de las columnas y agregar información de contexto a la tabla. Reemplazaremos los nombres de las columnas por nombres correctamente redactados, usando la función <code>cols_label()</code>, a la cual hay que darle los nombres de las columnas con el texto que queremos que tenga cada uno. Luego, utilizaremos la función <code>tab_header()</code> para agregar título y subtítulo, y la función <code>tab_source_note()</code> para agregar un texto de fuente debajo de la tabla.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pobreza_4</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pobreza_3</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># nombres de columnas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_label</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Región&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Comuna&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">poblacion</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Población&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">pobreza_n</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Cantidad&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">pobreza_p</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Porcentaje&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># título y subtítulo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_header</span><span style="color:#908caa">(</span><span style="color:#ea9a97">title</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Pobreza comunal&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">subtitle</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Cantidad y porcentaje de personas en situación de pobreza&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># texto fuente</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_source_note</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Fuente: Estimaciones de pobreza comunal 2022,&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_source_note</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Ministerio de Desarrollo Social&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pobreza_4.png"/>
</div>
<p>En este punto ya tenemos una tabla presentable, ordenada y elegante. Podemos guardar la tabla como una imagen con el comando <code>gtsave()</code>, incluirla en un reporte Quarto/RMarkdown o en una app Shiny.</p>




<h3 id="estilo-condicional-de-celdas">Estilo condicional de celdas
  <a href="#estilo-condicional-de-celdas"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Podemos seguir mejorando en la tabla agregando cambios condicionales en el estilo de celdas que cumplan con una condición puntual. Por ejemplo, queremos destacar celdas de la variable <code>poobreza_n</code> que superen cierto valor, debido a que nos parece relevante distinguir comunas donde exista una cierta cantidad de personas en condición de pobreza.</p>
<p>Para agregar estilos condicionales a las celdas de una o varias columnas, usamos la misma función <code>tab_style()</code> que usamos para darle un estilo a las columnas completas, pero esta vez, en el argumento de <code>location</code> que usamos para especificar la columna que queremos modificar, especificamos tanto una columna como un criterio para las filas. De esta forma, se indica que queremos cambiar el estilo de una columna, pero sólo si sus filas cumplen una condición determinada:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pobreza_5</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pobreza_4</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_fill</span><span style="color:#908caa">(</span><span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;red&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">alpha</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0.2</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pobreza_n</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                                   <span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pobreza_n</span> <span style="color:#908caa">&gt;</span> <span style="color:#f6c177">6000</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pobreza_5.png"/>
</div>




<h3 id="colorear-columnas-según-su-valor">Colorear columnas según su valor
  <a href="#colorear-columnas-seg%c3%ban-su-valor"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Podemos hacer que una columna de una variable numérica exprese su valor a través de una <strong>escala de colores</strong>. Así resulta mucho más fácil guiar la atención a las diferencias en los valores de las observaciones, ya que podemos identificar valores bajos y altos de la misma variable siguiendo el degradado de colores.</p>
<p>La función <code>data_color()</code> aplica colorización de celdas en base a los valores de la variable indicada en el argumento <code>column</code>. Si las variables numérica, especificamos que el método sea <code>numeric</code>, y luego tenemos varios argumentos que podemos especificar para modificar la colorización. Los principales son <code>domain</code>, donde se especifica el rango de la escala de colores (es decir, el valor que corresponde con el color mínimo y el valor del color máximo), y la paleta en <code>palette</code>, qué puede hacer un vector de colores que van desde el valor más bajo el valor más alto; es decir, el color asignado a los valores más bajos de la variable, y los colores siguientes en el degradado. En este caso, queremos que las cifras bajas sean de color blanco (igual que el fondo del gráfico), y a medida que el valor sea más alto sean de un rojo intenso y luego un rojo oscuro. El color más alto (rojo oscuro) corresponde al valor <code>0.3</code> o 30%, dado que en el contexto de medición de pobreza consideramos que eso ya es una cifra suficientemente alarmante. Los valores que queden fuera de este rango de cero a 30% van a adquirir el color de los datos perdidos (<code>na_color</code>), de modo que todos los valores iguales o mayores a 0.3 van a ser del color más alto.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pobreza_6</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pobreza_5</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">data_color</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pobreza_p</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">method</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;numeric&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">domain</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">0</span><span style="color:#908caa">,</span> <span style="color:#f6c177">0.3</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">na_color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;red4&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;red1&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;red4&#34;</span><span style="color:#908caa">))</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pobreza_6.png"/>
</div>
<p>Gracias al degradado de colores a las celdas tenemos una tabla que comunica mucho más que la versión anterior, dado que guía la interpretación de los datos a una variable puntual.</p>




<h3 id="estilo-avanzado-de-tablas">Estilo avanzado de tablas
  <a href="#estilo-avanzado-de-tablas"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Para finalizar con esta tabla, podemos personalizar con mayor detalle de todos los aspectos de la misma. En el bloque de código que viene a continuación, vamos a especificar múltiples modificaciones a la tabla:</p>
<ul>
<li>Cambiar el tamaño del texto de las celdas</li>
<li>Usar una tipografía o tipo de letra distinto para la tabla, usando tipografías de Google, con las funciones <code>opt_table_font()</code> y 
<a href="https://fonts.google.com" target="_blank" rel="noopener"><code>google_font()</code></a></li>
<li>Poner el subtítulo de la tabla en itálica con <code>tab_style()</code></li>
<li>Cambiar el color del texto de algunas columnas, ya que queremos que pasen a segundo plano, usando <code>tab_style()</code></li>
<li>Alinear los textos de título y subtítulo hacia el lado izquierdo, usando <code>tab_style()</code></li>
<li>Cambiar el color de fondo de los nombres de columnas, para crear una jerarquía en la tabla, usando <code>tab_style()</code></li>
<li>Eliminar las líneas de borde de la tabla con <code>opt_table_lines(&quot;none&quot;)</code>, para luego personalizar las líneas horizontales en <code>tab_options()</code>, poniéndolas de color blanco y ensanchándolas para que creen una separación entre filas</li>
<li>Crear un espaciado entre el subtítulo con el resto de la tabla, al ensanchar la línea divisoria entre ambas, usando <code>tab_options()</code></li>
<li>Agregar un color de fondo alternante de las filas, para guiar la lectura, usando <code>opt_row_striping()</code></li>
<li>Cambiar el texto de la fuente en la parte de abajo de la tabla, y creamos un espaciado entre la fuente y la tabla ensanchando la línea divisoria entre ambas, usando <code>tab_style()</code> y <code>tab_options()</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pobreza_7</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pobreza_6</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># texto de tabla más chico</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">size</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;small&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">list</span><span style="color:#908caa">(</span><span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(),</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#ea9a97">cells_column_labels</span><span style="color:#908caa">()))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># tipografía</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">opt_table_font</span><span style="color:#908caa">(</span><span style="color:#ea9a97">font</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">google_font</span><span style="color:#908caa">(</span><span style="color:#ea9a97">name</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Host Grotesk&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># subtítulo en itálicas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;italic&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_title</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;subtitle&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># texto de columna</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;grey60&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">poblacion</span><span style="color:#908caa">)))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># alineación de texto de titulares</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">align</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;left&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_title</span><span style="color:#908caa">())</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># color de fondo de títulos de columnas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_fill</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;grey92&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_column_labels</span><span style="color:#908caa">())</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># eliminar líneas por defecto</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">opt_table_lines</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;none&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># espaciado entre filas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">table_body.hlines.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;solid&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.hlines.width</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">2</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.hlines.color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># espaciado entre subtítulo y tabla</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">heading.border.bottom.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;solid&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">heading.border.bottom.color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">heading.border.bottom.width</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">12</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">heading.padding</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># filas con fondo alternante</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">opt_row_striping</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># texto fuente</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">source_notes.font.size</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;small&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">source_notes.padding</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">align</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;right&#34;</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_source_notes</span><span style="color:#908caa">())</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># espaciado tabla y fuente</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">table_body.border.bottom.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;solid&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.border.bottom.color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.border.bottom.width</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">12</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pobreza_7.png"/>
</div>
<p>La tabla terminada tiene una apariencia mucho más personalizada y atractiva 🥰</p>
<hr>




<h2 id="tabla-de-resultados-electorales">Tabla de resultados electorales
  <a href="#tabla-de-resultados-electorales"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>En el segundo ejemplo, haremos una pequeña tabla que resuma resultados electorales. En esta tabla, el sector político al que pertenezcan los candidatos o candidatas tendrá un color específico, pero este color se aplicará a una columna distinta al sector político.</p>
<p>Los datos fueron obtenidos desde el sitio web del Servel por medio de web scraping. 
<a href="https://github.com/bastianolea/servel_scraping_votaciones" target="_blank" rel="noopener">El procesamiento de los datos y los datos originales se encuentran en este repositorio</a>, pero para este ejemplo, cargaremos directamente el archivo que contiene todos los resultados oficiales, procesados y limpios.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">dplyr</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">tidyr</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">forcats</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">glue</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">lubridate</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">stringr</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># cargar datos remotamente desde el repositorio</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">datos_elecciones</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">readr</span><span style="color:#908caa">::</span><span style="color:#ea9a97">read_csv2</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;https://raw.githubusercontent.com/bastianolea/servel_scraping_votaciones/refs/heads/main/datos/resultados_alcaldes_2024.csv&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">datos_elecciones</span>
</span></span></code></pre></div><pre><code># A tibble: 1,922 × 11
   comuna    candidato         partido lista sector votos porcentaje total_votos
   &lt;chr&gt;     &lt;chr&gt;             &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
 1 ALGARROBO Marco Antonio Go… RN      Z - … Derec…  4250     0.276        15405
 2 ALGARROBO Veronica Maricel… IND     CAND… Indep…  2905     0.189        15405
 3 ALGARROBO Marcela Maritza … IND     CAND… Indep…  2677     0.174        15405
 4 ALGARROBO Alejandro Felipe… IND     CAND… Indep…  2425     0.157        15405
 5 ALGARROBO Carlos Orlando T… IND     CAND… Indep…  1089     0.0707       15405
 6 ALGARROBO Maria Luisa Hami… IND     CAND… Indep…   365     0.0237       15405
 7 ALGARROBO Gaston Dubournai… IND     F - … Indep…   332     0.0216       15405
 8 ALGARROBO Nulo/Blanco       &lt;NA&gt;    &lt;NA&gt;  Otros   1362     0.0884       15405
 9 ALHUE     Marcela Chamorro… IND     H - … Izqui…  3490     0.598         5841
10 ALHUE     Jose Andres Arel… IND     CAND… Indep…  1828     0.313         5841
# ℹ 1,912 more rows
# ℹ 3 more variables: mesas_escrutadas &lt;dbl&gt;, mesas_totales &lt;dbl&gt;,
#   mesas_porcentaje &lt;dbl&gt;
</code></pre>
<p>Habiendo cargado los datos, filtramos por una comuna que nos interese, y ordenamos las columnas:</p>
<ul>
<li>Convertimos el sector político (variable <code>sector</code>) en un factor ordenado.</li>
<li>Luego hacemos que la columna <code>candidato</code> también sea un factor cuyo orden depende del <code>porcentaje</code> obtenido.</li>
<li>Llevamos los votos nulos a la última posición del factor de candidatos para que aparezcan al final.</li>
<li>Ordenamos la tabla por el factor ordenado <code>candidato</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">comuna_elegida</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;PEÑALOLEN&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_elecciones_1</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">datos_elecciones</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">comuna</span> <span style="color:#908caa">==</span> <span style="color:#ea9a97">comuna_elegida</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># ordenar sector político</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">sector</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.factor</span><span style="color:#908caa">(</span><span style="color:#ea9a97">sector</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">sector</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">fct_relevel</span><span style="color:#908caa">(</span><span style="color:#ea9a97">sector</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Izquierda&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Derecha&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Independiente&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Otros&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># nulos al final de la tabla</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">fct_reorder</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">porcentaje</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">candidato</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">fct_relevel</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Nulo/Blanco&#34;</span><span style="color:#908caa">,</span><span style="color:#ea9a97">after</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">arrange</span><span style="color:#908caa">(</span><span style="color:#ea9a97">desc</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">partido</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">votos</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">porcentaje</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">sector</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_elecciones_1</span>
</span></span></code></pre></div><pre><code># A tibble: 5 × 5
  candidato                  partido votos porcentaje sector       
  &lt;fct&gt;                      &lt;chr&gt;   &lt;dbl&gt;      &lt;dbl&gt; &lt;fct&gt;        
1 Miguel Andres Concha Manso FA      52293     0.317  Izquierda    
2 Claudia Mora Vega          RN      52170     0.316  Derecha      
3 Carlos Alarcon Castro      IND     31217     0.189  Independiente
4 Eduardo Giesen Amtmann     IND      9321     0.0565 Independiente
5 Nulo/Blanco                &lt;NA&gt;    19928     0.121  Otros        
</code></pre>
<p>Procedemos a crear la tabla básica con <code>{gt}</code>, incluyendo un subtítulo en formato <em>markdown</em> que contiene dentro de sí el nombre de la comuna elegida a partir del objeto que usamos para filtrar los datos en el paso anterior. El 
<a href="https://quarto.org/docs/authoring/markdown-basics.html" target="_blank" rel="noopener">texto <em>markdown</em></a> permite darle estilo enriquecido al texto de forma sencilla usando símbolos, lo cual resulta conveniente para casos como éste.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">gt</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_elecciones_2</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_elecciones_1</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">gt</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># titulares</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_header</span><span style="color:#908caa">(</span><span style="color:#ea9a97">title</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">md</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;_Resultados parciales:_ Elecciones Municipales 2024&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">subtitle</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">md</span><span style="color:#908caa">(</span><span style="color:#ea9a97">glue</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;**{str_to_title(comuna_elegida)}**&#34;</span><span style="color:#908caa">)))</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_elecciones_2.png"/>
</div>
<p>Aplicamos el formato de porcentaje a la columna de porcentaje, y el formato numérico a la columna numérica. Luego definimos algunos aspectos del estilo de la tabla, como fondos de color para algunas columnas, una 
<a href="https://fonts.google.com" target="_blank" rel="noopener">tipografía personalizada desde Google Fonts</a>, alineaciones de textos, y estilos de textos distintos en los distintos elementos de la tabla.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_elecciones_3</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_elecciones_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># formato de números</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">fmt_percent</span><span style="color:#908caa">(</span><span style="color:#ea9a97">porcentaje</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">decimals</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">1</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">fmt_number</span><span style="color:#908caa">(</span><span style="color:#ea9a97">votos</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">decimals</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">sep_mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">dec_mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># estilo fondos de todas las celdas excepto partido</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">column</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">votos</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">porcentaje</span><span style="color:#908caa">)),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_fill</span><span style="color:#908caa">(</span><span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey96&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># tipografía</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">opt_table_font</span><span style="color:#908caa">(</span><span style="color:#ea9a97">font</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">google_font</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Open Sans&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># alineación de textos</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_align</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">partido</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">porcentaje</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">align</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;left&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_align</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#ea9a97">partido</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">align</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;center&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_hide</span><span style="color:#908caa">(</span><span style="color:#ea9a97">sector</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">opt_table_lines</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;none&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">opt_align_table_header</span><span style="color:#908caa">(</span><span style="color:#ea9a97">align</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;left&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># estilo de textos</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">column</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">partido</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">porcentaje</span><span style="color:#908caa">)),</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">weight</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;bold&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_column_labels</span><span style="color:#908caa">(),</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;italic&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">candidato</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Nulo/Blanco&#34;</span><span style="color:#908caa">),</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">weight</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;normal&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># etiquetas de columnas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_label</span><span style="color:#908caa">(</span><span style="color:#ea9a97">candidato</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Candidato/a&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">partido</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Partido&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">votos</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Votos&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">porcentaje</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;%&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_elecciones_3.png"/>
</div>




<h3 id="colorear-celdas-según-una-variable-categórica-o-factor">Colorear celdas según una variable categórica o factor
  <a href="#colorear-celdas-seg%c3%ban-una-variable-categ%c3%b3rica-o-factor"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Ahora viene lo entretenido. La tabla tiene una columna con una variable de partido político (<code>partido</code>), pero los datos contienen también una columna de <code>sector</code> político, que engloba a los partidos políticos. Vamos a asignar un color a las celdas del partido político dependiendo del sector político al que pertenecen; es decir, usar el contenido de una columna de la tabla para cambiar el estilo de <em>otra columna distinta</em> de la tabla.</p>
<p>Creamos una lista con los colores que queremos usar para la variable categórica <code>sector</code>, que representa el sector del espectro político al cual pueden pertenecer los partidos políticos.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">color</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">list</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;izquierda&#34;</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;#DB231D&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f6c177">&#34;derecha&#34;</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;#1D76DB&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f6c177">&#34;centro&#34;</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;#B16AD2&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#f6c177">&#34;independiente&#34;</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;#38B51D&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#f6c177">&#34;otros&#34;</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey50&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">levels</span><span style="color:#908caa">(</span><span style="color:#ea9a97">tabla_elecciones_1</span><span style="color:#908caa">$</span><span style="color:#ea9a97">sector</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><pre><code>[1] &quot;Izquierda&quot;     &quot;Derecha&quot;       &quot;Independiente&quot; &quot;Otros&quot;        
</code></pre>
<p>La función <code>data_color()</code>, que usamos anteriormente para dar color a variables numéricas en base a sus valores, también permite asignar colores a las variables en base a sus niveles, para el caso de variables categóricas o factores que contienen niveles o categorías de respuesta nominales u ordinales.</p>
<p>Para que esto funcione correctamente, es necesario que la variable esté en formato factor, lo cual hicimos en el primer paso de ordenar las columnas. La variable <code>sector</code> posee un determinado orden de sus niveles, que revisamos con la función <code>levels(tabla_elecciones_1$sector)</code>, Y en base al orden de estos niveles, especificamos los colores en la paleta, en el argumento <code>palette</code> de <code>data_color()</code>. Es en esta función donde especificamos que la información sale de la columna <code>sector</code>, pero afecta a la columna <code>partido</code>, y el efecto del color se aplica al texto, no al fondo (<code>apply_to = &quot;text&quot;</code>).</p>
<p>Una vez especificando esto, podemos repetir la misma operación pero aplicando el efecto al fondo (<code>apply_to = &quot;fill&quot;</code>) y dándole una transparencia de 20% (<code>alpha = 0.2</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_elecciones_4</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_elecciones_3</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># color texto partidos</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">data_color</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">sector</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">target_columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">partido</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">method</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;factor&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#ea9a97">color</span><span style="color:#908caa">$</span><span style="color:#ea9a97">izquierda</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span><span style="color:#908caa">$</span><span style="color:#ea9a97">derecha</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                         <span style="color:#ea9a97">color</span><span style="color:#908caa">$</span><span style="color:#ea9a97">independiente</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span><span style="color:#908caa">$</span><span style="color:#ea9a97">otros</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">apply_to</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;text&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># color fondo partidos</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">data_color</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">sector</span><span style="color:#908caa">,</span>  <span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">candidato</span> <span style="color:#908caa">!=</span> <span style="color:#f6c177">&#34;Nulo/Blanco&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">target_columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">partido</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">method</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;factor&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#ea9a97">color</span><span style="color:#908caa">$</span><span style="color:#ea9a97">izquierda</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span><span style="color:#908caa">$</span><span style="color:#ea9a97">derecha</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                         <span style="color:#ea9a97">color</span><span style="color:#908caa">$</span><span style="color:#ea9a97">independiente</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span><span style="color:#908caa">$</span><span style="color:#ea9a97">otros</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">alpha</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0.2</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">apply_to</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;fill&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">autocolor_text</span> <span style="color:#908caa">=</span> <span style="color:#3e8fb0">FALSE</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_elecciones_4.png"/>
</div>
<p>Repetir el efecto de colonización al texto y al fondo por separado nos permite darle un efecto más sofisticado al color de las celdas, donde el fondo de la celda tiene el mismo color que el texto, pero más suave.</p>
<p>Finalmente, aplicamos otras personalizaciones a la tabla, principalmente para crear un espacio entre las celdas y otros elementos de la tabla, y especificar el color de fondo y de texto de los votos nulos/blancos, que son menos relevantes.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_elecciones_5</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_elecciones_4</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># color fondo nulos</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">data_color</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">sector</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">candidato</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Nulo/Blanco&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">target_columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">partido</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey96&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">alpha</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">1</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">apply_to</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;fill&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">autocolor_text</span> <span style="color:#908caa">=</span> <span style="color:#3e8fb0">FALSE</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># estilo fila nulos</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">candidato</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Nulo/Blanco&#34;</span><span style="color:#908caa">),</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey70&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># notas al pie</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">table_body.hlines.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;solid&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.hlines.width</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">8</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.hlines.color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.vlines.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;solid&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.vlines.width</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">8</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.vlines.color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_footnote</span><span style="color:#908caa">(</span><span style="color:#ea9a97">footnote</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">glue</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Fuente: Servel&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_footnotes</span><span style="color:#908caa">(),</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">align</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;right&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">size</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">px</span><span style="color:#908caa">(</span><span style="color:#f6c177">12</span><span style="color:#908caa">)))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">heading.subtitle.font.size</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">19</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">heading.padding</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">1</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">heading.border.bottom.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;solid&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">heading.border.bottom.width</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">16</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">heading.border.bottom.color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">table_body.border.bottom.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;solid&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.border.bottom.width</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">5</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table_body.border.bottom.color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">footnotes.padding</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">1</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_elecciones_5.png"/>
</div>
<p>Obtenemos como resultado una tabla concisa pero a la vez informativa.</p>
<hr>




<h2 id="tabla-de-producto-interno-bruto-regional">Tabla de Producto Interno Bruto regional
  <a href="#tabla-de-producto-interno-bruto-regional"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>El tercer y último ejemplo será una tabla con datos regionales para un rango de varios años; es decir, una tabla con una alta cantidad de celdas numéricas en cuadrícula.</p>
<p>Los datos serán obtenidos directamente desde las 
<a href="https://si3.bcentral.cl/siete/" target="_blank" rel="noopener">estadísticas del Banco Central de Chile</a>, utilizando web scraping, siguiendo el 
<a href="https://github.com/bastianolea/economia_chile" target="_blank" rel="noopener">trabajo previo que hice con estadísticas económicas</a> para un 
<a href="../../../apps/economia_chile/">visualizador interactivo de indicadores económicos</a>.</p>
<p>Cargamos el paquete <code>{rvest}</code>, especificamos la dirección web donde está ubicada la tabla que nos interesa, y hacemos web scraping de la tabla ubicada en esa página:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">dplyr</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">rvest</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># url con la tabla</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">url</span> <span style="color:#908caa">&lt;-</span> <span style="color:#f6c177">&#34;https://si3.bcentral.cl/Siete/ES/Siete/Cuadro/CAP_ESTADIST_REGIONAL/MN_REGIONAL1/CCNN2018_PIB_REGIONAL_T?cbFechaInicio=2018&amp;cbFechaTermino=2024&amp;cbFrecuencia=ANNUAL&amp;cbCalculo=NONE&amp;cbFechaBase=&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># abrir sesión y obtener código de fuente del sitio</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">sitio</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">session</span><span style="color:#908caa">(</span><span style="color:#ea9a97">url</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#ea9a97">read_html</span><span style="color:#908caa">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># obtener la tabla del sitio, sin convertir unidades</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tablas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">sitio</span> <span style="color:#908caa">|&gt;</span> <span style="color:#ea9a97">html_table</span><span style="color:#908caa">(</span><span style="color:#ea9a97">convert</span> <span style="color:#908caa">=</span> <span style="color:#3e8fb0">FALSE</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># limpieza mínima</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tablas[[1]]</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">rename</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">2</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#f6c177">-1</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib</span>
</span></span></code></pre></div><pre><code># A tibble: 19 × 7
   region                              `2018` `2019` `2020` `2021` `2022` `2023`
   &lt;chr&gt;                               &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
 1 Región de Arica y Parinacota        1.427  1.406  1.317  1.531  1.637  1.597 
 2 Región de Tarapacá                  4.342  4.561  4.380  4.772  4.786  4.944 
 3 Región de Antofagasta               16.011 15.997 15.691 15.574 15.582 15.948
 4 Región de Atacama                   3.707  3.514  3.531  4.010  4.009  4.095 
 5 Región de Coquimbo                  5.835  5.954  5.667  6.123  6.107  6.319 
 6 Región de Valparaíso                13.703 13.663 12.840 14.152 14.891 14.913
 7 Región Metropolitana de Santiago    78.853 79.590 72.830 82.627 84.789 84.959
 8 Región del Libertador General Bern… 7.868  7.819  7.522  8.227  8.250  8.086 
 9 Región del Maule                    7.153  7.105  6.963  7.585  7.767  7.832 
10 Región de Ñuble                     2.864  2.870  2.764  3.093  3.171  3.161 
11 Región del Biobío                   11.272 11.426 10.803 11.792 12.081 12.798
12 Región de La Araucanía              5.159  5.257  5.011  5.633  5.873  5.924 
13 Región de Los Ríos                  2.455  2.472  2.371  2.610  2.677  2.662 
14 Región de Los Lagos                 6.294  6.427  6.101  6.615  6.904  7.048 
15 Región de Aysén del General Carlos… 1.222  1.235  1.128  1.163  1.202  1.247 
16 Región de Magallanes y de la Antár… 1.831  1.923  1.680  1.807  1.921  1.894 
17 Subtotal regionalizado              169.9… 171.2… 160.6… 177.0… 181.0… 183.0…
18 Extrarregional                      19.439 19.419 18.320 22.270 22.315 20.692
19 Producto Interno Bruto              189.4… 190.6… 178.9… 199.2… 203.3… 203.7…
</code></pre>
<p>Nos encontramos con una tabla que tiene 19 filas y seis columnas numéricas, correspondientes a los valores del Producto Interno Bruto para cada uno de los años. Procedemos a limpiar estos datos, debido a que la tabla usa puntos como divisores de miles, y esto hace que R interprete los números como si fueran decimales. Usamos <code>stringr::str_remove()</code> para eliminar todos los puntos en todas las columnas que empiecen con <code>20</code> (los años), y luego las convertimos a numéricas.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">stringr</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">forcats</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">pib_regional</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pib</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">across</span><span style="color:#908caa">(</span><span style="color:#ea9a97">starts_with</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;20&#34;</span><span style="color:#908caa">),</span> <span style="color:#908caa">~</span><span style="color:#ea9a97">str_remove</span><span style="color:#908caa">(</span><span style="color:#ea9a97">.x</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;\\.&#34;</span><span style="color:#908caa">)))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">across</span><span style="color:#908caa">(</span><span style="color:#ea9a97">starts_with</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;20&#34;</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">as.numeric</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">str_detect</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Región&#34;</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">pib_regional</span>
</span></span></code></pre></div><pre><code># A tibble: 16 × 7
   region                              `2018` `2019` `2020` `2021` `2022` `2023`
   &lt;chr&gt;                                &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 Región de Arica y Parinacota          1427   1406   1317   1531   1637   1597
 2 Región de Tarapacá                    4342   4561   4380   4772   4786   4944
 3 Región de Antofagasta                16011  15997  15691  15574  15582  15948
 4 Región de Atacama                     3707   3514   3531   4010   4009   4095
 5 Región de Coquimbo                    5835   5954   5667   6123   6107   6319
 6 Región de Valparaíso                 13703  13663  12840  14152  14891  14913
 7 Región Metropolitana de Santiago     78853  79590  72830  82627  84789  84959
 8 Región del Libertador General Bern…   7868   7819   7522   8227   8250   8086
 9 Región del Maule                      7153   7105   6963   7585   7767   7832
10 Región de Ñuble                       2864   2870   2764   3093   3171   3161
11 Región del Biobío                    11272  11426  10803  11792  12081  12798
12 Región de La Araucanía                5159   5257   5011   5633   5873   5924
13 Región de Los Ríos                    2455   2472   2371   2610   2677   2662
14 Región de Los Lagos                   6294   6427   6101   6615   6904   7048
15 Región de Aysén del General Carlos…   1222   1235   1128   1163   1202   1247
16 Región de Magallanes y de la Antár…   1831   1923   1680   1807   1921   1894
</code></pre>
<p>Ahora podemos crear nuestra tabla básica con <code>{gt}</code>, especificando el formato apropiado para todas las columnas numéricas en una sola instancia <code>fmt_number()</code>. Esto es posible porque podemos usar selectores de <code>{dplyr}</code> en los argumentos de columnas de <code>{gt}</code>, así que podemos pedirle que aplique un formato, estilo, u otras herramientas de <code>{gt}</code> a una o varias columnas seleccionadas por su nombre parcial o por su tipo de datos. En este caso, aplicamos el formato a todas las columnas numéricas usando <code>where(is.numeric)</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">gt</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib_regional_1</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">pib_regional</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">gt</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_align</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;right&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">region</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># formato de columnas numéricas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">fmt_number</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">where</span><span style="color:#908caa">(</span><span style="color:#ea9a97">is.numeric</span><span style="color:#908caa">),</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">sep_mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">decimals</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pib_regional_1.png"/>
</div>
<p>Con una sola línea formateamos seis columnas. Yey! 🥳</p>




<h3 id="cálculo-de-diferencia-porcentual-entre-años">Cálculo de diferencia porcentual entre años
  <a href="#c%c3%a1lculo-de-diferencia-porcentual-entre-a%c3%b1os"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Luego producir esta tabla, vamos a realizar una transformación en los datos para poder calcular la variación anual, entendida como la diferencia porcentual entre un año y el anterior. Para realizar este cálculo, lo más conveniente es transformar los datos a formato largo; es decir, una fila por observación, y una variable por columna. Usamos <code>pivot_longer()</code> para transformar las seis columnas que teníamos de datos numéricos por año, en una sola columna de datos numéricos, y otra columna que contengan los años a los que corresponde cada observación.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">tidyr</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">pib_regional_long</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">pib_regional</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">pivot_longer</span><span style="color:#908caa">(</span><span style="color:#ea9a97">cols</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">where</span><span style="color:#908caa">(</span><span style="color:#ea9a97">is.numeric</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>               <span style="color:#ea9a97">names_to</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;año&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#ea9a97">values_to</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;valor&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><p>Ahora, es muy sencillo calcular la variación porcentual entre una observación y otra: agrupamos los datos por región, y calculamos cada valor dividido por el valor anterior (la celda de arriba, obtenida con <code>lag()</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">pib_regional_cambio</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">pib_regional_long</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># ordenar observaciones</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">arrange</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">año</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">group_by</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># calcular cambio</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">cambio</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">valor</span><span style="color:#908caa">/</span><span style="color:#ea9a97">lag</span><span style="color:#908caa">(</span><span style="color:#ea9a97">valor</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">cambio</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">1</span> <span style="color:#908caa">-</span> <span style="color:#ea9a97">cambio</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ungroup</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#908caa">!</span><span style="color:#ea9a97">is.na</span><span style="color:#908caa">(</span><span style="color:#ea9a97">cambio</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">pib_regional_cambio</span>
</span></span></code></pre></div><pre><code># A tibble: 80 × 4
   region                           año   valor    cambio
   &lt;chr&gt;                            &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 Región Metropolitana de Santiago 2019  79590 -0.00935 
 2 Región Metropolitana de Santiago 2020  72830  0.0849  
 3 Región Metropolitana de Santiago 2021  82627 -0.135   
 4 Región Metropolitana de Santiago 2022  84789 -0.0262  
 5 Región Metropolitana de Santiago 2023  84959 -0.00200 
 6 Región de Antofagasta            2019  15997  0.000874
 7 Región de Antofagasta            2020  15691  0.0191  
 8 Región de Antofagasta            2021  15574  0.00746 
 9 Región de Antofagasta            2022  15582 -0.000514
10 Región de Antofagasta            2023  15948 -0.0235  
# ℹ 70 more rows
</code></pre>
<p>Con nuestra nueva variable <code>cambio</code> calculada, ahora volvemos a transformar los datos para que estén en el formato <em>ancho</em>; es decir, nuevamente cada celda ubicada en una columna distinta dependiendo del año al cual corresponde. Así, volvemos a obtener seis columnas de datos numéricos, una para cada año, pero esta vez con la diferencia porcentual de los valores en vez del valor absoluto.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">pib_regional_cambio_wide</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">pib_regional_cambio</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">año</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">cambio</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">pivot_wider</span><span style="color:#908caa">(</span><span style="color:#ea9a97">names_from</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">año</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">values_from</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cambio</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">pib_regional_cambio_wide</span>
</span></span></code></pre></div><pre><code># A tibble: 16 × 6
   region                             `2019`   `2020`   `2021`   `2022`   `2023`
   &lt;chr&gt;                               &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 Región Metropolitana de Santiago -9.35e-3  0.0849  -0.135   -2.62e-2 -0.00200
 2 Región de Antofagasta             8.74e-4  0.0191   0.00746 -5.14e-4 -0.0235 
 3 Región de Arica y Parinacota      1.47e-2  0.0633  -0.162   -6.92e-2  0.0244 
 4 Región de Atacama                 5.21e-2 -0.00484 -0.136    2.49e-4 -0.0215 
 5 Región de Aysén del General Car… -1.06e-2  0.0866  -0.0310  -3.35e-2 -0.0374 
 6 Región de Coquimbo               -2.04e-2  0.0482  -0.0805   2.61e-3 -0.0347 
 7 Región de La Araucanía           -1.90e-2  0.0468  -0.124   -4.26e-2 -0.00868
 8 Región de Los Lagos              -2.11e-2  0.0507  -0.0842  -4.37e-2 -0.0209 
 9 Región de Los Ríos               -6.92e-3  0.0409  -0.101   -2.57e-2  0.00560
10 Región de Magallanes y de la An… -5.02e-2  0.126   -0.0756  -6.31e-2  0.0141 
11 Región de Tarapacá               -5.04e-2  0.0397  -0.0895  -2.93e-3 -0.0330 
12 Región de Valparaíso              2.92e-3  0.0602  -0.102   -5.22e-2 -0.00148
13 Región de Ñuble                  -2.09e-3  0.0369  -0.119   -2.52e-2  0.00315
14 Región del Biobío                -1.37e-2  0.0545  -0.0915  -2.45e-2 -0.0593 
15 Región del Libertador General B…  6.23e-3  0.0380  -0.0937  -2.80e-3  0.0199 
16 Región del Maule                  6.71e-3  0.0200  -0.0893  -2.40e-2 -0.00837
</code></pre>
<p>Generamos una nueva tabla <code>{gt}</code> con las diferencias porcentuales entre años, especificando que estas columnas numéricas ahora son porcentajes:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib_regional_2</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">pib_regional_cambio_wide</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">gt</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_align</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;right&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">region</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">fmt_percent</span><span style="color:#908caa">(</span><span style="color:#ea9a97">where</span><span style="color:#908caa">(</span><span style="color:#ea9a97">is.numeric</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">decimals</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">1</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">dec_mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_label</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Región&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pib_regional_2.png"/>
</div>




<h3 id="colorear-múltiples-columnas-simultáneamente">Colorear múltiples columnas simultáneamente
  <a href="#colorear-m%c3%baltiples-columnas-simult%c3%a1neamente"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Ahora que tenemos una cuadrícula de valores numéricos en nuestra tabla, resulta conveniente aplicar color a cada celda dependiendo de su valor. Esto permite una interpretación más rápida de una gran cantidad de datos, debido a que seguía la vista hacia los valores anómalos o destacables, Y se facilita la interpretación de patrones generales en los datos a partir del color.</p>
<p>Usamos la función <code>data_color()</code> para colorizar las columnas, aprovechando las selección de columnas con la función <code>where(is.numeric)</code> para aplicar el color a todas las columnas numéricas de una sola vez. Usaremos la paleta 
<a href="https://github.com/sjmgarnier/viridis" target="_blank" rel="noopener">viridis</a>, que facilita la interpretación de diferencia en los datos, y además es inclusiva para personas daltónicas.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib_regional_3</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pib_regional_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">data_color</span><span style="color:#908caa">(</span><span style="color:#ea9a97">where</span><span style="color:#908caa">(</span><span style="color:#ea9a97">is.numeric</span><span style="color:#908caa">),</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">method</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;numeric&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;viridis&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pib_regional_3.png"/>
</div>
<p>Otra opción es especificar que los colores se apliquen solamente al texto, para generar una tabla más liviana a la vista. Especificamos una paleta básica que va de rojo a verde pasando por negro. Usamos el método <code>bin</code> para segmentar los colores en rangos discretos, en vez de usar un degradado de colores, para facilitar la interpretación. Los rangos para cada uno de los colores se establece en el argumento <code>bins</code>, donde definimos que el color rojo se va aplicar a valores hasta -2%, luego negro del -2% al 2%, y de ahí en adelante verde.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib_regional_4</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pib_regional_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">data_color</span><span style="color:#908caa">(</span><span style="color:#ea9a97">where</span><span style="color:#908caa">(</span><span style="color:#ea9a97">is.numeric</span><span style="color:#908caa">),</span> 
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">method</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;bin&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">apply_to</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;text&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">palette</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;#bf2f2f&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;black&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;#279f2b&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">bins</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#908caa">-</span><span style="color:#3e8fb0">Inf</span><span style="color:#908caa">,</span> <span style="color:#f6c177">-0.02</span><span style="color:#908caa">,</span> <span style="color:#f6c177">0.02</span><span style="color:#908caa">,</span> <span style="color:#3e8fb0">Inf</span><span style="color:#908caa">))</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pib_regional_4.png"/>
</div>
<p>Usamos categorías de colores en vez de degradados para facilitar la interpretación, debido a que los degradados tendrían demasiados valores de color en una cuadrícula que ya es suficientemente compleja, dificultando que las personas asocian rápidamente diferentes sombras de rojo o de verde a interpretaciones significativas. En lugar de eso, simplificamos la interpretación al solamente colorear valores negativos y positivos, y mantener un rango de valores dentro de la normalidad que carecen de un color distintivo (negro).</p>
<p>Finalmente, aplicamos más personalizaciones de estilo a la tabla para que resulte más atractiva:</p>
<ul>
<li>Limitar el ancho de la primera columna con <code>cols_width()</code></li>
<li>Aplicar negritas a los nombres de variables e itálicas a la primera columna con <code>tab_style()</code></li>
<li>Eliminar las líneas horizontales de arriba y abajo de la tabla</li>
<li>Disminuir el espaciado interior de las celdas para aumentar la densidad de información con <code>tab_options(data_row.padding = px(6))</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib_regional_5</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pib_regional_4</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># ancho máximo de columna región</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">cols_width</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span> <span style="color:#908caa">~</span> <span style="color:#ea9a97">px</span><span style="color:#908caa">(</span><span style="color:#f6c177">220</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># filas alternas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">opt_row_striping</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># estilo de columnas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">weight</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;bold&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_column_labels</span><span style="color:#908caa">())</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;italic&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">region</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># eliminar líneas horizontales de arriba y abajo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">table.border.top.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;hidden&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">table.border.bottom.style</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;hidden&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># cambiar el espaciado interno de las celdas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_options</span><span style="color:#908caa">(</span><span style="color:#ea9a97">data_row.padding</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">px</span><span style="color:#908caa">(</span><span style="color:#f6c177">6</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># título y fuentes</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_header</span><span style="color:#908caa">(</span><span style="color:#ea9a97">title</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Producto Interno Bruto regional&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>             <span style="color:#ea9a97">subtitle</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Variación anual, por regiones&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_source_note</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Fuente: Banco Central de Chile&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pib_regional_5.png"/>
</div>




<h3 id="estilo-condicional-a-través-de-varias-columnas">Estilo condicional a través de varias columnas
  <a href="#estilo-condicional-a-trav%c3%a9s-de-varias-columnas"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Ahora nos ubicaremos en un caso de uso más complejo. Queremos destacar los valores más extremos de la tabla a partir de una condicional: si los valores de las celdas son menores a -3%, queremos que el texto esté en negritas. Como ejemplo, aplicaremos esto a una sola columna, dejando las demás en gris para que se note el cambio:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># una columna</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib_regional_5a</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pib_regional_5</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey70&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">`2019`</span><span style="color:#908caa">:</span><span style="color:#ea9a97">`2022`</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">weight</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;bold&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">`2023`</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">`2023`</span> <span style="color:#908caa">&lt;</span> <span style="color:#f6c177">-0.03</span><span style="color:#908caa">))</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pib_regional_5a.png"/>
</div>
<p>Si bien esto funciona, el problema que vamos a tener radica en que cada especificación de las columnas a las que va a aplicar el estilo dependen también de la evaluación de la condicional en la misma columna. En el fondo, que un valor adquiera o no el estilo depende de si está en la columna, y si la fila de <em>esa misma</em> columna cumple con la condición establecida. Entonces, si queremos aplicar lo mismo a otra columna, habría que modificar tanto la columna como la condición, porque la condición depende también de la columna.</p>
<p>Entonces, ¿qué hacer si queremos aplicar lo mismo a más de una columna? Podemos repetir el llamado de <code>tab_style()</code> para cada uno de los años, o bien, podemos hacer un solo llamado a <code>tab_style()</code>, pero especificando más de una combinación de columna/fila en <code>locations</code> al mismo tiempo:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># dos columnas</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib_regional_5b</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pib_regional_5</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey70&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">`2019`</span><span style="color:#908caa">:</span><span style="color:#ea9a97">`2021`</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">weight</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;bold&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">list</span><span style="color:#908caa">(</span><span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">`2022`</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">`2022`</span> <span style="color:#908caa">&lt;</span> <span style="color:#f6c177">-0.03</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">`2023`</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">`2023`</span> <span style="color:#908caa">&lt;</span> <span style="color:#f6c177">-0.03</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pib_regional_5b.png"/>
</div>
<p>Esto funciona porque se puede entregar a <code>locations</code> una lista con múltiples funciones que especifiquen el lugar en la tabla en que se quiere aplicar el estilo.</p>
<p>Sin embargo, esta solución se volvería extremadamente repetitiva si queremos aplicarlo a seis columnas o más. Habría que escribir manualmente la especificación de <code>cells_body()</code> para cada una de las combinaciones de años y filas.</p>
<p>A continuación comparto una solución a este problema que involucra una iteración sobre los nombres de las columnas usando <code>purrr::map()</code>. La idea es que, si el argumento <code>locations</code> acepta múltiples columnas por medio de una lista (como hicimos en el paso anterior), podemos usar <code>map()</code> para especificar una sola vez la columna y la condición, y multiplicarla por todas las columnas que necesitemos.</p>
<p>Lo que estamos haciendo es una lista con múltiples instancias de <code>cells_body()</code>, una para cada elemento en el vector <code>columnas</code>. Dentro de <code>cells_body()</code> se usa la sintaxis <code>!!sym()</code> para transformar el nombre de una columna escrito como texto a un <em>símbolo</em>, para poder hacer la comparación apropiadamente (porque no se puede hacer <code>&quot;1&quot; &lt; 0</code>, tiene que ser <code>1 &lt; 0</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># múltiples columnas con filas condicionales</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># obtener nombres de columas a las que queremos aplicar el estilo</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">columnas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">pib_regional_cambio_wide</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">where</span><span style="color:#908caa">(</span><span style="color:#ea9a97">is.numeric</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">names</span><span style="color:#908caa">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_pib_regional_5c</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_pib_regional_5</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">tab_style</span><span style="color:#908caa">(</span><span style="color:#ea9a97">style</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cell_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">weight</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;bold&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6e6a86"># aplicar el estilo a todas las columnas, iterando la función cells_body por los nombres de columnas</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ea9a97">locations</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">purrr</span><span style="color:#908caa">::</span><span style="color:#ea9a97">map</span><span style="color:#908caa">(</span><span style="color:#ea9a97">columnas</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                                   <span style="color:#908caa">~</span><span style="color:#ea9a97">cells_body</span><span style="color:#908caa">(</span>
</span></span><span style="display:flex;"><span>                                     <span style="color:#ea9a97">columns</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">.x</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                                     <span style="color:#ea9a97">rows</span> <span style="color:#908caa">=</span> <span style="color:#908caa">!!</span><span style="color:#ea9a97">sym</span><span style="color:#908caa">(</span><span style="color:#ea9a97">.x</span><span style="color:#908caa">)</span> <span style="color:#908caa">&lt;</span> <span style="color:#f6c177">-0.03</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>                                   <span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#908caa">)</span>
</span></span></code></pre></div><div style="background-color:white;padding:12px;border-radius:5px;max-width:480px;">
<img src="tabla_pib_regional_5c.png"/>
</div>
<p>De esta forma, usamos un poco de magia de iteraciones con <code>{purrr}</code> y sintaxis avanzada de R con <code>{rlang}</code> para poder aplicar un formato condicional a múltiples columnas de una tabla.</p>
<hr>




<h2 id="otros-recursos-para-tablas-gt">Otros recursos para tablas <code>{gt}</code>
  <a href="#otros-recursos-para-tablas-gt"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<ul>
<li>Documentación oficial: 
<a href="https://gt.rstudio.com" target="_blank" rel="noopener">https://gt.rstudio.com</a></li>
<li>
<a href="https://themockup.blog/static/resources/gt-cookbook.html#table-customization" target="_blank" rel="noopener">https://themockup.blog/static/resources/gt-cookbook.html#table-customization</a></li>
<li>
<a href="https://gt.albert-rapp.de" target="_blank" rel="noopener">https://gt.albert-rapp.de</a></li>
</ul>
<hr>
<p>Si este tutorial te sirvió, por favor considera hacerme una pequeña donación para poder tomarme un cafecito mientras escribo el siguiente tutorial 🥺</p>
<div style = "height: 18px;">
</div>
<div>
  <div style="display: flex;
  justify-content: center;
  align-items: center;">
    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="bastimapache" data-color="#FFDD00" data-emoji="☕"  data-font="Cookie" data-text="Regálame un cafecito" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff" ></script>
  </div>

        
        <details closed class="f6 fw7 input-reset">
  <dl class="f6 lh-copy">
    <dt class="fw7">Fecha de publicación:</dt>
    <dd class="fw5 ml0">November 19, 2024</dd>
  </dl>
  <dl class="f6 lh-copy">
    <dt class="fw7">Extensión:</dt>
    <dd class="fw5 ml0">27 minute read, 5562 words</dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Categorías:</dt>
    <dd class="fw5 ml0"> <a href="http://localhost:4321/categories/tutoriales">tutoriales</a> </dd>
  </dl>
  
  
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Tags:</dt>
    <dd class="fw5 ml0"> <a href="http://localhost:4321/tags/tablas">tablas</a>  <a href="http://localhost:4321/tags/web-scraping">web scraping</a>  <a href="http://localhost:4321/tags/chile">Chile</a> </dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Ver también:</dt>
    
    <dd class="fw5 ml0"><a href="/blog/web_scraping_github_actions/">Web scraping automatizado en R con GitHub Actions</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/portafolio_trabajos_r/">Portafolio de trabajos previos en R</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/casen_introduccion/">Cargar y explorar datos de la encuesta Casen en R, usando factor de expansión</a></dd>
    
  </dl>
</details>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="http://localhost:4321/blog/surveydown_encuestas/">&larr; Crea encuestas en R usando {surveydown}</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="http://localhost:4321/blog/analisis_sentimiento_llm/">Análisis de sentimiento usando modelos de lenguaje (LLM) locales en R &rarr;</a>
  
</div>

      </footer>
    </article>
    
      <div class="post-comments pa0 pa4-l mt4">
  
    
      <script src="https://utteranc.es/client.js"
              repo="bastianolea/blog-bastianolea-r"
              issue-term="pathname"
              theme="github-light"
              label="comments"
              crossorigin="anonymous"
              async
              type="text/javascript">
      </script>
    
  
</div>

    
  </section>
</main>
<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2024 Bastián Olea Herrera, Chile
      <span class="middot-divider"></span>
      Hecho con <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Basado en <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span>, de <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/bastianolea" title="github" target="_blank" rel="me noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://x.com/bastimapache" title="twitter" target="_blank" rel="me noopener">
      <i class="fab fa-twitter fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://bsky.app/profile/bastianolea.rbind.io" title="bluesky" target="_blank" rel="me noopener">
      <i class="fab fa-bluesky fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.linkedin.com/in/bastianolea/" title="linkedin" target="_blank" rel="me noopener">
      <i class="fab fa-linkedin fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/raccunnie" title="instagram" target="_blank" rel="me noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.goodreads.com/user/show/53224910-basti-n-olea-herrera" title="goodreads" target="_blank" rel="me noopener">
      <i class="fab fa-goodreads fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="/contact/" title="envelope" >
      <i class="fas fa-envelope fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/about/" title="Bastián Olea: Sobre mi">Sobre mi</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Bastián Olea: Contacto">Contacto</a>
      
      <a class="dib pv1 ph2 link" href="/license/" title="Bastián Olea: Licencia">Licencia</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
